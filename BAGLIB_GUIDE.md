# åŒ…åº“ç³»ç»Ÿ - å¿«é€Ÿå‚è€ƒæŒ‡å—

## ğŸ’ åŠŸèƒ½æ¦‚è§ˆ

**åŒ…åº“ç³»ç»Ÿ**å…è®¸ç©å®¶åœ¨æ¸¸æˆä¸­é€‰æ‹©ä¸åŒçš„å—æ°”åŒ…æ¨¡å‹ã€‚ç³»ç»ŸåŒ…å«10ä¸ªç‹¬ç‰¹çš„åŒ…æ¬¾ï¼Œä»æ™®é€šçš„åœ†å½¢åŒ…åˆ°ä¼ è¯´çº§çš„ç«ç„°åŒ…ã€‚

## ğŸ“‹ åŒ…åº“ç»„ä»¶æ¶æ„

```
miniprogram/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ bag_models.js          â† 10ä¸ªåŒ…æ¨¡å‹å®šä¹‰ï¼ˆåˆ›å»ºå‡½æ•°ã€å…ƒæ•°æ®ï¼‰
â”‚   â””â”€â”€ bag_3d.js              â† 3Dæ¸²æŸ“å™¨ï¼ˆæ¨¡å‹åˆ‡æ¢ã€åˆ—è¡¨è·å–ï¼‰
â””â”€â”€ pages/index/
    â”œâ”€â”€ index.js               â† é¡µé¢é€»è¾‘ï¼ˆåˆå§‹åŒ–ã€äº¤äº’å¤„ç†ï¼‰
    â”œâ”€â”€ index.wxml             â† UIå¸ƒå±€ï¼ˆåŒ…åº“é¢æ¿ã€ç½‘æ ¼é¡¹ï¼‰
    â””â”€â”€ index.wxss             â† æ ·å¼ï¼ˆé¢æ¿æ ·å¼ã€åŠ¨ç”»ï¼‰
```

## ğŸš€ æ•°æ®æµ

```
onLoad()
  â†“
init3DRenderer()
  â†“ (3Dæ¸²æŸ“å™¨åˆå§‹åŒ–å®Œæˆ)
  â†“
initBagLibrary()
  â”œâ”€â†’ getBagModelList()
  â”‚    â””â”€â†’ Object.values(BAG_MODELS).map(...)
  â”‚         è¿”å› [classical, jelly, hedgehog, ...]
  â”œâ”€â†’ setData({ bagModelList, currentBagModelId })
  â””â”€â†’ UIç»‘å®šdataï¼Œæ˜¾ç¤º10ä¸ªåŒ…
```

## ğŸ¯ å…³é”®å‡½æ•°

### bag_models.js
- `createClassicalBag(THREE, materials)` - åˆ›å»ºç»å…¸åœ†å½¢åŒ…
- `createJellyBag(THREE, materials)` - åˆ›å»ºQå¼¹æœå†»åŒ…
- ... (å…±10ä¸ªåˆ›å»ºå‡½æ•°)
- `BAG_MODELS` - åŒ…æ¨¡å‹å®šä¹‰å¯¹è±¡

### bag_3d.js
- `getBagModelList()` - è¿”å› `[{id, name, description, rarity}, ...]`
- `changeBagModel(modelId)` - åˆ‡æ¢åŒ…æ¨¡å‹
- `createBagModel(THREE, materials)` - åœ¨åœºæ™¯ä¸­åˆ›å»ºæ¨¡å‹
- `currentBagModelId` - å½“å‰é€‰ä¸­çš„åŒ…ID

### index.js
- `initBagLibrary()` - åˆå§‹åŒ–åŒ…åº“æ•°æ®
- `openBagLibrary()` - æ‰“å¼€åŒ…åº“é¢æ¿
- `closeBagLibrary()` - å…³é—­åŒ…åº“é¢æ¿
- `selectBagModel(e)` - å¤„ç†åŒ…é€‰æ‹©äº‹ä»¶

## ğŸ–¼ï¸ UIç»“æ„

### åŒ…åº“é¢æ¿å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’ åŒ…åº“                  âœ•  â”‚  â† å¤´éƒ¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®  â”‚
â”‚ â”‚  ğŸ’          â”‚ ç»å…¸åœ†å½¢åŒ…  â”‚  â”‚
â”‚ â”‚              â”‚ æ™®é€š åœ†æ¶¦å¯çˆ± â”‚  â”‚ â† åŒ…é¡¹ç½‘æ ¼ (2åˆ—)
â”‚ â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯        â”‚  â”‚
â”‚ â”‚ â•­â”€â”€â”€â”€â”€â”€â•® â•­â”€â”€â”€â”€â”€â”€â•®      â”‚  â”‚
â”‚ â”‚ â”‚  ğŸ’  â”‚ â”‚  ğŸ’  â”‚ ...  â”‚  â”‚
â”‚ â”‚ â•°â”€â”€â”€â”€â”€â”€â•¯ â•°â”€â”€â”€â”€â”€â”€â•¯      â”‚  â”‚
â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åŒ…é¡¹ç»“æ„
```
<view class="bag-lib-item">
  <view class="bag-preview-container">
    <view class="bag-preview-icon">ğŸ’</view>
    âœ“  (é€‰ä¸­æ—¶æ˜¾ç¤º)
  </view>
  <view class="bag-lib-info">
    <text>ç»å…¸åœ†å½¢åŒ…</text>
    <text>common</text>
    <text>åœ†æ¶¦å¯çˆ±</text>
  </view>
  <view class="bag-rarity-label">æ™®é€š</view>
</view>
```

## ğŸ¨ æ ·å¼å…³é”®ç‚¹

| å…ƒç´  | æ ·å¼ç±» | è¯´æ˜ |
|------|-------|------|
| å®¹å™¨ | `.bag-lib-item` | åŒ…é¡¹å®¹å™¨ |
| é¢„è§ˆ | `.bag-preview-container` | é¢„è§ˆåŒºï¼ŒåŒ…å«emojiå’Œé€‰ä¸­æ ‡è®° |
| å›¾æ ‡ | `.bag-preview-icon` | emojiï¼Œå¸¦æµ®åŠ¨åŠ¨ç”» |
| æ ‡è®° | `.bag-selected-badge` | é€‰ä¸­å‹¾é€‰ âœ“ |
| ä¿¡æ¯ | `.bag-lib-info` | åŒ…åã€ç¨€æœ‰åº¦ã€æè¿° |
| æ ‡ç­¾ | `.bag-rarity-label` | ç¨€æœ‰åº¦æ ‡ç­¾ |

### åŠ¨ç”»
```css
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8rpx); }
}

/* åº”ç”¨äº .bag-preview-icon */
animation: float 3s ease-in-out infinite;
```

## ğŸ“Š æ•°æ®ç»“æ„

### bagModelList æ•°ç»„
```javascript
[
  {
    id: 'classical',
    name: 'ç»å…¸åœ†å½¢åŒ…',
    description: 'ç»å…¸çš„åœ†å½¢å—æ°”åŒ…ï¼Œåœ†æ¶¦å¯çˆ±',
    rarity: 'common'
  },
  {
    id: 'jelly',
    name: 'Qå¼¹æœå†»åŒ…',
    description: 'è½¯å¼¹æ„Ÿæœå†»ä½“è´¨ï¼ŒQQè½¯è½¯',
    rarity: 'common'
  },
  // ... (å…±10ä¸ª)
]
```

### ç¨€æœ‰åº¦çº§åˆ«
| çº§åˆ« | æ˜¾ç¤ºæ–‡å­— | é¢œè‰² | åŒ…æ•°é‡ |
|------|--------|------|--------|
| common | æ™®é€š | ç°è‰² | 2ä¸ª |
| uncommon | ä¼˜ç§€ | ç»¿è‰² | 2ä¸ª |
| rare | ç¨€æœ‰ | è“è‰² | 2ä¸ª |
| epic | å²è¯— | ç´«è‰² | 2ä¸ª |
| legendary | ä¼ è¯´ | é‡‘è‰² | 2ä¸ª |

## ğŸ”§ å¸¸è§æ“ä½œ

### è·å–å½“å‰é€‰ä¸­çš„åŒ…
```javascript
this.data.currentBagModelId  // 'classical', 'jelly', ...
```

### åˆ‡æ¢åŒ…æ¨¡å‹
```javascript
// åœ¨selectBagModelä¸­è°ƒç”¨
this.bag3DRenderer.changeBagModel(modelId);
this.setData({ currentBagModelId: modelId });
```

### æ‰“å¼€/å…³é—­åŒ…åº“
```javascript
// æ‰“å¼€
this.setData({ showBagLibrary: true });

// å…³é—­
this.setData({ showBagLibrary: false });
```

### ä¿å­˜ç”¨æˆ·é€‰æ‹©
```javascript
wx.setStorageSync('selectedBag', this.data.currentBagModelId);
```

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### Q: åŒ…åº“æ‰“å¼€åæ²¡æœ‰æ˜¾ç¤ºä»»ä½•åŒ…
**A:** æ£€æŸ¥ `initBagLibrary()` æ˜¯å¦åœ¨ `init3DRenderer()` å®Œæˆåè°ƒç”¨

### Q: åŒ…æ¨¡å‹åˆ‡æ¢å¤±è´¥
**A:** ç¡®è®¤ `bag3DRenderer` å·²å®Œå…¨åˆå§‹åŒ–ï¼Œæ£€æŸ¥ `changeBagModel()` è¿”å›å€¼

### Q: åŒ…é¢„è§ˆæ˜¾ç¤ºä¸ºç©º
**A:** è¿™æ˜¯æ­£å¸¸çš„ï¼Œç°åœ¨ç”¨emojiæ›¿ä»£3Dé¢„è§ˆä»¥æå‡æ€§èƒ½

### Q: é€‰ä¸­çŠ¶æ€ä¸æ˜¾ç¤º
**A:** æ£€æŸ¥ `currentBagModelId` æ˜¯å¦ä¸åŒ…IDåŒ¹é…

## ğŸ“ ä¿®æ”¹åŒ…æ¨¡å‹

### æ·»åŠ æ–°åŒ…æ¬¾
1. åœ¨ `bag_models.js` ä¸­æ·»åŠ  `createNewBag()` å‡½æ•°
2. åœ¨ `BAG_MODELS` å¯¹è±¡ä¸­æ·»åŠ å®šä¹‰
3. åœ¨ `module.exports` ä¸­å¯¼å‡ºå‡½æ•°
4. è‡ªåŠ¨æ˜¾ç¤ºåœ¨åŒ…åº“ä¸­

### ä¿®æ”¹åŒ…æ˜¾ç¤ºåç§°
ç¼–è¾‘ `bag_models.js` ä¸­çš„ `BAG_MODELS` å¯¹è±¡ï¼š
```javascript
const BAG_MODELS = {
  classical: {
    id: 'classical',
    name: 'æ–°åç§°',  // â† ä¿®æ”¹è¿™é‡Œ
    description: '...',
    rarity: 'common',
    creator: createClassicalBag
  }
}
```

## ğŸš¨ é‡è¦æ³¨æ„äº‹é¡¹

1. **åˆå§‹åŒ–é¡ºåº** - å¿…é¡»åœ¨ `init3DRenderer()` å®Œæˆåè°ƒç”¨ `initBagLibrary()`
2. **å†…å­˜ç®¡ç†** - åˆ‡æ¢åŒ…æ¨¡å‹æ—¶è‡ªåŠ¨æ¸…ç†æ—§æ¨¡å‹èµ„æº
3. **æ•°æ®æŒä¹…åŒ–** - ç”¨æˆ·é€‰æ‹©çš„åŒ…éœ€è¦æ‰‹åŠ¨ä¿å­˜åˆ° `localStorage`
4. **æ€§èƒ½è€ƒè™‘** - å½“å‰ä½¿ç”¨emojié¢„è§ˆï¼Œå¦‚éœ€3Dé¢„è§ˆéœ€å¦è¡Œå®ç°

## ğŸ“ ç›¸å…³å‘½ä»¤

```bash
# æŸ¥çœ‹æ‰€æœ‰åŒ…æ¨¡å‹
grep "id: '" miniprogram/utils/bag_models.js | head -10

# æŸ¥çœ‹åŒ…åº“ç›¸å…³ä»£ç 
grep -n "bagLibrary\|bagModel" miniprogram/pages/index/index.js
```

## ğŸ“ å­¦ä¹ èµ„æº

- `bag_models.js` - Three.jså‡ ä½•ä½“åˆ›å»ºç¤ºä¾‹
- `bag_3d.js` - Three.jsæ¸²æŸ“å™¨æ¨¡å¼
- `index.js` - å¼‚æ­¥åˆå§‹åŒ–å’Œæ•°æ®ç»‘å®š
- `index.wxml` - åŠ¨æ€åˆ—è¡¨ç»‘å®šå’Œæ¡ä»¶æ¸²æŸ“

---

**æœ€åæ›´æ–°ï¼š** 2024å¹´ | **çŠ¶æ€ï¼š** âœ… æ­£å¼å‘å¸ƒ
