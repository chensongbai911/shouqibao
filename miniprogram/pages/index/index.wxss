@import "./3d-styles.wxss";

/* ========== 设计系统变量 - 轻量清新风格 ========== */
page {
  /* 字体系统 - 圆润粗壮无衬线体，增强力量感和卡通感 */
  --font-title: 'PingFang SC', 'Source Han Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
  --font-number: 'DIN Alternate', 'Helvetica Neue', Arial, sans-serif;
  --font-comic: 'Comic Sans MS', cursive, sans-serif;

  /* 字号系统 */
  --font-size-title: 36rpx;
  --font-size-body: 28rpx;
  --font-size-number: 48rpx;
  --font-size-small: 24rpx;
  --font-size-huge: 100rpx;

  /* 间距系统 */
  --spacing-xs: 8rpx;
  --spacing-sm: 16rpx;
  --spacing-md: 24rpx;
  --spacing-lg: 32rpx;
  --spacing-container: 16rpx;

  /* ========== 深色主题配色 - 专业沉浸、层级分明 ========== */
  /* 背景层: 深蓝黑/深灰，营造沉浸氛围 */
  --color-bg-primary: #1a1f2e;
  --color-bg-secondary: #16213e;

  /* 信息层: 明亮饱和色用于核心数据 */
  --color-primary: #FFD700;       /* 金黄色 - 核心数据强调 */
  --color-secondary: #FFE135;     /* 明黄色 - 核心数据 */
  --color-accent: #00D4FF;        /* 亮蓝色 - 强调，深色优化 */

  /* 强调色: 金黄/亮蓝用于核心数据 */
  --color-highlight: #FFD700;     /* 金黄 */
  --color-damage: #FFD700;        /* 伤害数值金黄 */
  --color-danger: #FF6B6B;        /* 明亮警示红 - 深色优化 */

  /* 辅助色 */
  --color-candy-blue: #00D4FF;    /* 亮蓝 */
  --color-mint: #1a2e4a;          /* 深蓝渐变背景 */

  /* 文字色: 纯白/浅灰，对比度≥7:1 */
  --color-text: #FFFFFF;          /* 主文字纯白 */
  --color-text-secondary: #B8B8B8; /* 辅助文字浅灰 */
  --color-text-light: #888888;    /* 浅色文字 */

  /* 边框与分割线 */
  --color-border: #2D3748;        /* 深灰边框 */
  --color-divider: #1F2937;       /* 分割线 */

  /* 毛玻璃效果 */
  --glass-bg: rgba(255, 255, 255, 0.85);
  --glass-blur: blur(20rpx);
  --glass-border: rgba(255, 255, 255, 0.6);
}

/* 隐藏旧导航栏 - 改为全屏沉浸式 */
.custom-navbar {
  display: none;
}

.navbar-spacer {
  display: none;
}

/* 页面容器 - 全屏沉浸式 */
.container {
  min-height: 100vh;
  height: 100vh;
  max-height: 100vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  padding: 0;
  background: transparent;
  position: relative;
  transition: background 0.5s ease;
  box-sizing: border-box;
}

/* ========== 多巴胺风格渐变背景 ========== */
.gradient-background {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: -1;
  overflow: hidden;
}

.gradient-layer {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  /* 深色主题：深蓝→深灰，专业沉浸感，突出角色 */
  background: linear-gradient(180deg,
    #0F1419 0%,      /* 深蓝黑 */
    #1a1f2e 25%,     /* 深蓝灰 */
    #16213e 50%,     /* 深靛蓝 */
    #0f1419 75%,     /* 深蓝黑 */
    #0a0e17 100%     /* 更深蓝黑 */
  );
  background-size: 100% 100%;
  animation: gradient-flow 15s ease-in-out infinite;
}

@keyframes gradient-flow {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* 浮动装饰圆点 - 更大更柔和 */
.bg-particle {
  position: absolute;
  border-radius: 50%;
  opacity: 0.5;
  pointer-events: none;
}

.bg-particle.p1 {
  width: 120rpx;
  height: 120rpx;
  background: radial-gradient(circle, rgba(0, 212, 255, 0.2) 0%, transparent 70%);
  top: 10%;
  left: 15%;
  animation: particle-float 8s ease-in-out infinite;
}

.bg-particle.p2 {
  width: 80rpx;
  height: 80rpx;
  background: radial-gradient(circle, rgba(255, 215, 0, 0.15) 0%, transparent 70%);
  top: 25%;
  right: 20%;
  animation: particle-float 10s ease-in-out infinite reverse;
}

.bg-particle.p3 {
  width: 100rpx;
  height: 100rpx;
  background: radial-gradient(circle, rgba(102, 126, 234, 0.1) 0%, transparent 70%);
  bottom: 30%;
  left: 10%;
  animation: particle-float 12s ease-in-out infinite 2s;
}

.bg-particle.p4 {
  width: 60rpx;
  height: 60rpx;
  background: radial-gradient(circle, rgba(255, 234, 167, 0.35) 0%, transparent 70%);
  top: 45%;
  right: 8%;
  animation: particle-float 9s ease-in-out infinite 1s;
}

.bg-particle.p5 {
  width: 90rpx;
  height: 90rpx;
  background: radial-gradient(circle, rgba(129, 236, 236, 0.3) 0%, transparent 70%);
  bottom: 15%;
  right: 25%;
  animation: particle-float 11s ease-in-out infinite 3s;
}

.bg-particle.p6 {
  width: 70rpx;
  height: 70rpx;
  background: radial-gradient(circle, rgba(255, 107, 107, 0.2) 0%, transparent 70%);
  top: 60%;
  left: 30%;
  animation: particle-float 7s ease-in-out infinite 0.5s;
}

.bg-particle.p7 {
  width: 50rpx;
  height: 50rpx;
  background: radial-gradient(circle, rgba(162, 155, 254, 0.3) 0%, transparent 70%);
  top: 15%;
  left: 60%;
  animation: particle-float 13s ease-in-out infinite 4s;
}

.bg-particle.p8 {
  width: 110rpx;
  height: 110rpx;
  background: radial-gradient(circle, rgba(116, 185, 255, 0.25) 0%, transparent 70%);
  bottom: 40%;
  right: 40%;
  animation: particle-float 14s ease-in-out infinite 2.5s;
}

@keyframes particle-float {
  0%, 100% {
    transform: translate(0, 0) scale(1);
  }
  25% {
    transform: translate(30rpx, -40rpx) scale(1.1);
  }
  50% {
    transform: translate(-20rpx, 30rpx) scale(0.9);
  }
  75% {
    transform: translate(40rpx, 20rpx) scale(1.05);
  }
}

/* ========== 深色主题背景 - 高对比度、低压迫感 ========== */
.container.dark-mode .gradient-layer {
  /* 深灰/炭黑，避免纯黑的生硬感 */
  background: linear-gradient(180deg,
    #1A1A1A 0%,       /* 深灰 */
    #121212 50%,      /* 炭黑 */
    #1A1A1A 100%
  );
  background-size: 100% 100%;
  animation: none;
}

.container.dark-mode .bg-particle {
  opacity: 0.2;
  /* 深色模式下粒子带科技感光效 */
  filter: saturate(1.2) brightness(1.1);
}

/* ========== 打击动效系统 ========== */

/* 屏幕震动效果 */
.container.screen-shake {
  animation: screen-shake 0.05s ease-in-out;
}

@keyframes screen-shake {
  0%, 100% { transform: translate3d(0, 0, 0); }
  25% { transform: translate3d(-2px, 1px, 0); }
  50% { transform: translate3d(2px, -1px, 0); }
  75% { transform: translate3d(-1px, 2px, 0); }
}

/* 连击闪光背景 */
.combo-flash-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: radial-gradient(circle at center, rgba(255, 107, 107, 0.15) 0%, transparent 70%);
  pointer-events: none;
  z-index: 100;
  opacity: 0;
  transition: opacity 0.1s ease;
}

.combo-flash-overlay.active {
  opacity: 1;
  animation: combo-flash 0.1s ease-out;
}

@keyframes combo-flash {
  0% { opacity: 0; background: radial-gradient(circle at center, rgba(255, 107, 107, 0.3) 0%, transparent 70%); }
  50% { opacity: 1; }
  100% { opacity: 0; }
}

/* 连击结算提示 */
.combo-result {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.5);
  z-index: 500;
  opacity: 0;
  pointer-events: none;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.combo-result.show {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}

.combo-result-text {
  display: block;
  font-family: var(--font-number);
  font-size: 48rpx;
  font-weight: 700;
  color: #fff;
  text-shadow:
    0 0 20rpx rgba(255, 107, 107, 0.8),
    0 0 40rpx rgba(255, 107, 107, 0.5),
    2rpx 2rpx 4rpx rgba(0, 0, 0, 0.5);
  background: linear-gradient(135deg, var(--color-danger) 0%, var(--color-accent) 100%);
  padding: var(--spacing-md) var(--spacing-lg);
  border-radius: var(--spacing-sm);
  animation: combo-result-pulse 0.5s ease-in-out infinite alternate;
}

@keyframes combo-result-pulse {
  0% { transform: scale(1); }
  100% { transform: scale(1.05); }
}

/* 动态背景装饰 */
.container::before {
  content: '';
  position: absolute;
  top: -50%;
  right: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
  animation: rotate-bg 20s linear infinite;
  pointer-events: none;
}

.container::after {
  content: '';
  position: absolute;
  bottom: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.05) 0%, transparent 70%);
  animation: rotate-bg 30s linear infinite reverse;
  pointer-events: none;
}

@keyframes rotate-bg {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ========== 深色模式 - 高对比度、低压迫感 ========== */
.container.dark-mode {
  /* 已统一默认为深色模式背景 */
  background: linear-gradient(180deg, #0F1419 0%, #1a1f2e 50%, #0a0e17 100%);
}

.container.dark-mode::before,
.container.dark-mode::after {
  /* 科技感光效 - 透明/暗纹理 */
  background: radial-gradient(circle, rgba(72, 219, 251, 0.08) 0%, transparent 70%);
}

/* ========== 受气包容器 - 上下左右居中 ========== */
.bag-area {
  flex: 1;
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
  z-index: auto;
}

.bag-container {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  z-index: auto;
}

.bag-3d-canvas {
  width: 100%;
  height: 100%;
  display: block;
  z-index: auto;
}

/* ========== 圆形分数卡片（缩小版） ========== */
.score-circle {
  position: relative;
  z-index: 10;
  width: 360rpx;  /* 180px */
  height: 360rpx;
  border-radius: 50%;
  background: linear-gradient(180deg, #fff 0%, #DFE6E9 100%);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  box-shadow: 0 12rpx 40rpx rgba(45, 52, 54, 0.15),
              0 0 0 4rpx rgba(78, 205, 196, 0.3) inset;
  margin-bottom: var(--spacing-md);  /* 24px */
  flex-shrink: 0;
}

.score-circle .score-label {
  font-family: var(--font-title);
  font-size: var(--font-size-body);  /* 28px 正文 */
  color: var(--color-text);
  font-weight: 400;  /* Regular */
  letter-spacing: 2rpx;
  margin-bottom: var(--spacing-xs);  /* 8px */
}

.score-circle .score-value {
  font-family: var(--font-number);
  font-size: var(--font-size-number);  /* 48px 数字 */
  font-weight: 700;  /* Bold */
  background: linear-gradient(135deg, #FFEAA7 0%, #fdcb6e 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  line-height: 1;
}

/* 连击徽章 */
.combo-badge {
  position: absolute;
  top: -10rpx;
  right: -10rpx;
  background: linear-gradient(135deg, #FF6B6B 0%, #FF9A76 100%);
  color: #fff;
  font-family: var(--font-number);
  font-size: var(--font-size-small);  /* 24px */
  font-weight: 700;
  padding: var(--spacing-xs) var(--spacing-sm);  /* 8px 16px */
  border-radius: var(--spacing-sm);  /* 16px */
  box-shadow: 0 8rpx 20rpx rgba(255, 107, 107, 0.5);
  animation: combo-pulse 0.5s ease-in-out infinite alternate;
}

@keyframes combo-pulse {
  from { transform: scale(1); }
  to { transform: scale(1.1); }
}

/* 旧的分数显示样式（保留兼容） */
.score-display {
  display: none;
}

.score-label {
  font-family: var(--font-title);
  font-size: var(--font-size-body);  /* 28px */
  color: var(--color-text);
  margin-bottom: var(--spacing-xs);  /* 8px */
  font-weight: 400;
  letter-spacing: 2rpx;
}

.score-value {
  font-family: var(--font-number);
  font-size: var(--font-size-number);  /* 48px 数字 */
  font-weight: 700;
  /* 亮黄渐变，强调数字 */
  background: linear-gradient(135deg, #FFEAA7 0%, #fdcb6e 50%, #f39c12 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 4rpx 8rpx rgba(253, 203, 110, 0.3);
  animation: score-glow 2s ease-in-out infinite;
}

@keyframes score-glow {
  0%, 100% {
    filter: brightness(1);
    transform: scale(1);
  }
  50% {
    filter: brightness(1.2);
    transform: scale(1.02);
  }
}

/* 粒子特效 - 覆盖全屏 */
.particles-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  pointer-events: none;
  z-index: 100;
}

.particle {
  position: absolute;
  border-radius: 50%;
  pointer-events: none;
  animation: particle-float 0.6s ease-out forwards;
}

@keyframes particle-float {
  0% {
    transform: translate(0, 0) scale(1);
    opacity: 1;
  }
  100% {
    transform: translate(var(--tx), var(--ty)) scale(0);
    opacity: 0;
  }
}

/* 伤害飘字 - 覆盖全屏 */
.damage-texts-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  pointer-events: none;
  z-index: 200;
}

/* ========== 漫画风格伤害数字系统 ========== */
.damage-text-comic {
  position: absolute;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  animation: comic-damage-float 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

.damage-text-comic.normal .damage-number-comic {
  font-family: var(--font-number);
  font-size: 56rpx;
  font-weight: 900;
  color: #fff;
  text-shadow:
    3rpx 3rpx 0 #2D3436,
    -2rpx -2rpx 0 #2D3436,
    2rpx -2rpx 0 #2D3436,
    -2rpx 2rpx 0 #2D3436,
    0 6rpx 10rpx rgba(0, 0, 0, 0.3);
  /* 漫画描边效果 */
  -webkit-text-stroke: 2rpx #2D3436;
  letter-spacing: -2rpx;
}

/* 暴击样式 - 爆炸气泡包裹 */
.damage-text-comic.crit {
  animation: comic-crit-float 1s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

.damage-text-comic.crit .damage-value-comic {
  font-family: var(--font-number);
  font-size: 28rpx;
  font-weight: 900;
  color: #fff;
  letter-spacing: 2rpx;
  margin-bottom: -10rpx;
  z-index: 2;
  text-shadow: 2rpx 2rpx 4rpx rgba(0, 0, 0, 0.5);
}

.damage-text-comic.crit .damage-number-comic {
  font-family: var(--font-number);
  font-size: 80rpx;
  font-weight: 900;
  color: #fff;
  text-shadow:
    4rpx 4rpx 0 #C0392B,
    -3rpx -3rpx 0 #C0392B,
    3rpx -3rpx 0 #C0392B,
    -3rpx 3rpx 0 #C0392B,
    0 8rpx 16rpx rgba(0, 0, 0, 0.4);
  -webkit-text-stroke: 3rpx #C0392B;
  letter-spacing: -4rpx;
  z-index: 2;
}

/* 暴击爆炸气泡 */
.crit-explosion-bubble {
  position: absolute;
  width: 180rpx;
  height: 180rpx;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  /* 橙红渐变背景 */
  background: radial-gradient(circle,
    #FF6B6B 0%,
    #FF8E53 40%,
    #FF6B6B 70%,
    transparent 100%
  );
  border-radius: 50%;
  z-index: 1;
  animation: bubble-pulse 0.3s ease-out;
}

/* 爆炸尖刺 */
.explosion-spike {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-left: 12rpx solid transparent;
  border-right: 12rpx solid transparent;
  border-bottom: 40rpx solid #FFEAA7;
  transform-origin: center bottom;
}

.explosion-spike.s1 { transform: translate(-50%, -100%) rotate(0deg); }
.explosion-spike.s2 { transform: translate(-50%, -100%) rotate(45deg); }
.explosion-spike.s3 { transform: translate(-50%, -100%) rotate(90deg); }
.explosion-spike.s4 { transform: translate(-50%, -100%) rotate(135deg); }
.explosion-spike.s5 { transform: translate(-50%, -100%) rotate(180deg); }
.explosion-spike.s6 { transform: translate(-50%, -100%) rotate(225deg); }
.explosion-spike.s7 { transform: translate(-50%, -100%) rotate(270deg); }
.explosion-spike.s8 { transform: translate(-50%, -100%) rotate(315deg); }

@keyframes bubble-pulse {
  0% {
    transform: translate(-50%, -50%) scale(0.3);
    opacity: 1;
  }
  50% {
    transform: translate(-50%, -50%) scale(1.2);
    opacity: 0.9;
  }
  100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 0.85;
  }
}

/* 漫画伤害弹出动画 */
@keyframes comic-damage-float {
  0% {
    transform: translateY(0) scale(0.3) rotate(-15deg);
    opacity: 0;
  }
  20% {
    transform: translateY(-30rpx) scale(1.3) rotate(8deg);
    opacity: 1;
  }
  40% {
    transform: translateY(-50rpx) scale(1) rotate(-3deg);
    opacity: 1;
  }
  100% {
    transform: translateY(-120rpx) scale(0.7) rotate(0deg);
    opacity: 0;
  }
}

/* 暴击漫画弹出动画 - 更剧烈 */
@keyframes comic-crit-float {
  0% {
    transform: translateY(0) scale(0.2) rotate(-20deg);
    opacity: 0;
  }
  15% {
    transform: translateY(-40rpx) scale(1.4) rotate(10deg);
    opacity: 1;
  }
  30% {
    transform: translateY(-70rpx) scale(1.2) rotate(-5deg);
    opacity: 1;
  }
  60% {
    transform: translateY(-110rpx) scale(1) rotate(2deg);
    opacity: 1;
  }
  100% {
    transform: translateY(-180rpx) scale(0.6) rotate(0deg);
    opacity: 0;
  }
}

/* 保留旧样式兼容 */
.damage-text {
  position: absolute;
  font-weight: bold;
  text-shadow: 2rpx 2rpx 4rpx rgba(0, 0, 0, 0.5);
  animation: damage-float 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  pointer-events: none;
}

.damage-text.normal {
  font-size: 48rpx;
  color: #FFEAA7;  /* 亮黄 */
}

.damage-text.crit {
  font-size: 72rpx;
  color: #FF6B6B;  /* 愤怒红 */
  animation: damage-float-crit 1s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

/* 伤害数字弹出动画 - 匹配设计规范 */
@keyframes damage-float {
  0% {
    transform: translateY(0) scale(0.5);
    opacity: 0;
  }
  20% {
    transform: translateY(-20rpx) scale(1.2);
    opacity: 1;
  }
  40% {
    transform: translateY(-40rpx) scale(1);
    opacity: 1;
  }
  100% {
    transform: translateY(-100rpx) scale(0.8);
    opacity: 0;
  }
}

/* 暴击伤害弹出动画 - 更夸张的效果 */
@keyframes damage-float-crit {
  0% {
    transform: translateY(0) scale(0.5) rotate(-10deg);
    opacity: 0;
  }
  15% {
    transform: translateY(-30rpx) scale(1.3) rotate(5deg);
    opacity: 1;
  }
  30% {
    transform: translateY(-60rpx) scale(1.2) rotate(-3deg);
    opacity: 1;
  }
  60% {
    transform: translateY(-100rpx) scale(1) rotate(0deg);
    opacity: 1;
  }
  100% {
    transform: translateY(-150rpx) scale(0.8) rotate(0deg);
    opacity: 0;
  }
}

/* 武器信息 */
.weapon-info {
  position: relative;
  z-index: 10;
  display: none; /* 旧武器信息隐藏 */
}

/* 当前武器徽章 */
.current-weapon-badge {
  position: absolute;
  top: 200rpx;
  right: 40rpx;
  display: flex;
  align-items: center;
  gap: 8rpx;
  background: rgba(255, 255, 255, 0.95);
  padding: 12rpx 24rpx;
  border-radius: 32rpx;  /* 16px 统一圆角 */
  box-shadow: 0 8rpx 24rpx rgba(45, 52, 54, 0.15);
  z-index: 20;
}

.weapon-badge-icon {
  font-size: 36rpx;
}

.weapon-badge-damage {
  font-size: 32rpx;  /* 16px */
  font-weight: 700;
  color: #FF9A76;  /* 温暖橙 */
}

/* ========== 武器选择区域（横向滚动） ========== */
.weapons-section {
  position: relative;
  z-index: 10;
  width: 100%;
  margin-bottom: 40rpx;
}

.section-title {
  font-size: 48rpx;  /* 24px */
  font-weight: 600;  /* 标题加粗 */
  color: #2D3436;  /* 深灰 */
  text-align: center;
  margin-bottom: 32rpx;
  letter-spacing: 2rpx;
}

/* 去掉下划线装饰 */
.section-title::after {
  display: none;
}

/* ========== 横向滚动容器（增强版） ========== */
.weapons-scroll {
  width: 100%;
  white-space: nowrap;
  position: relative;
}

/* 滚动容器包装层 */
.weapons-section {
  position: relative;
  z-index: 10;
  width: 100%;
  margin-bottom: 0;
  padding-bottom: calc(160rpx + env(safe-area-inset-bottom, 40rpx));
  flex-shrink: 0;
}

/* 渐变遮罩：右侧暗示可滚动 */
.weapons-section::after {
  content: '';
  position: absolute;
  top: 80rpx;
  right: 0;
  width: 80rpx;
  height: calc(100% - 80rpx);
  background: linear-gradient(90deg, transparent 0%, rgba(223, 230, 233, 0.9) 100%);  /* 浅灰渐变 */
  pointer-events: none;
  z-index: 5;
}

/* 滚动箭头提示 */
.weapons-section::before {
  content: '›';
  position: absolute;
  top: 50%;
  right: 16rpx;
  transform: translateY(-50%);
  font-size: 48rpx;
  color: rgba(78, 205, 196, 0.8);  /* 治愈蓝 */
  z-index: 10;
  pointer-events: none;
  animation: scroll-hint 1.5s ease-in-out infinite;
}

@keyframes scroll-hint {
  0%, 100% {
    opacity: 0.6;
    transform: translateY(-50%) translateX(0);
  }
  50% {
    opacity: 1;
    transform: translateY(-50%) translateX(8rpx);
  }
}

.weapons-row {
  display: inline-flex;
  padding: 20rpx 32rpx;
  padding-right: 100rpx; /* 给渐变遮罩预留空间 */
  gap: 24rpx;
}

/* 旧的grid布局隐藏 */
.weapons-grid {
  display: none;
}

/* 武器卡片（紧凑版） */
.weapon-card {
  width: 260rpx;  /* 130px，更紧凑 */
  min-width: 260rpx;
  background: rgba(255, 255, 255, 0.85);  /* 白色半透明 */
  border-radius: 32rpx;
  padding: 24rpx 16rpx;
  display: flex;
  flex-direction: column;
  align-items: center;
  backdrop-filter: blur(10px);
  border: 2rpx solid rgba(78, 205, 196, 0.3);  /* 治愈蓝边框 */
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  position: relative;
  overflow: hidden;
  box-shadow: 0 6rpx 20rpx rgba(45, 52, 54, 0.1),
              inset 0 0 20rpx rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
}

.weapon-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), transparent);
  opacity: 0;
  transition: opacity 0.3s;
}

.weapon-card:active {
  transform: scale(0.95);
  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.2);
}

.weapon-card:active::before {
  opacity: 1;
}

.weapon-card.active {
  border: 2rpx solid transparent;
  background: linear-gradient(135deg, #4ECDC4 0%, #44A08D 100%);  /* 治愈蓝渐变 */
  box-shadow: 0 10rpx 30rpx rgba(78, 205, 196, 0.4),
              inset 0 0 15rpx rgba(255, 255, 255, 0.3);
  transform: scale(1.02);
}

.weapon-card.active::before {
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), transparent);
  opacity: 1;
  animation: shimmer 2s ease-in-out infinite;
}

@keyframes shimmer {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.6; }
}

.weapon-card.locked {
  opacity: 0.5;
  filter: grayscale(0.8) brightness(0.8);
}

.weapon-icon {
  font-size: 52rpx;  /* 缩小 */
  margin-bottom: 10rpx;
  filter: drop-shadow(0 4rpx 10rpx rgba(0, 0, 0, 0.2));
  transition: transform 0.3s;
}

.weapon-card.active .weapon-icon {
  animation: icon-bounce 0.6s ease infinite;
}

@keyframes icon-bounce {
  0%, 100% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-6rpx) scale(1.05); }
}

.weapon-name-text {
  font-size: 24rpx;  /* 缩小 */
  color: #2D3436;  /* 深灰 */
  font-weight: 600;
  margin-bottom: 6rpx;
}

.weapon-card.active .weapon-name-text {
  color: #fff;
}

.weapon-damage-text {
  font-size: 28rpx;
  color: #FF9A76;  /* 温暖橙 */
  font-weight: 700;
}

.weapon-card.active .weapon-damage-text {
  color: #FFEAA7;  /* 亮黄 */
}

/* 锁定遮罩 */
.weapon-lock-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 32rpx;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6rpx;
}

.weapon-lock-overlay .lock-icon {
  position: static;
  font-size: 48rpx;
}

.weapon-lock-overlay .lock-score {
  font-size: 24rpx;
  color: #fff;
  font-weight: 600;
}

/* 旧的锁定样式 */
.weapon-unlock-hint {
  display: none;
}

.lock-icon {
  position: absolute;
  top: 15rpx;
  right: 15rpx;
  font-size: 36rpx;
  filter: drop-shadow(0 2rpx 6rpx rgba(0, 0, 0, 0.5));
}

/* ========== 简化控制按钮 ========== */
.controls-simple {
  position: fixed;
  bottom: 60rpx;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
  gap: 40rpx;
  padding: 16rpx 40rpx;
  background: rgba(255, 255, 255, 0.95);
  border-radius: 32rpx;  /* 16px 统一圆角 */
  box-shadow: 0 8rpx 32rpx rgba(45, 52, 54, 0.12);
  z-index: 100;
}

.control-icon {
  width: 80rpx;
  height: 80rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 40rpx;
  border-radius: 50%;
  background: transparent;
  transition: all 0.2s ease;
}

.control-icon:active {
  transform: scale(0.9);
  background: rgba(78, 205, 196, 0.15);  /* 治愈蓝 */
}

.control-icon.primary {
  background: linear-gradient(135deg, #FF9A76 0%, #FF6B6B 100%);  /* 温暖橙到愤怒红 */
  box-shadow: 0 4rpx 16rpx rgba(255, 154, 118, 0.4);
}

.control-icon.primary:active {
  transform: scale(0.9);
}

/* 旧的控制按钮组隐藏 */
.controls {
  display: none;
  position: relative;
  z-index: 10;
  width: 100%;
  max-width: 650rpx;
  display: flex;
  gap: 20rpx;
  padding: 0 20rpx;
  margin-bottom: 40rpx;
  box-sizing: border-box;
}

.control-btn {
  flex: 1;
  padding: 28rpx;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.15) 100%);
  border-radius: 25rpx;
  color: #fff;
  font-size: 30rpx;
  font-weight: 800;
  border: 2rpx solid rgba(255, 255, 255, 0.3);
  backdrop-filter: blur(20px);
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: 0 10rpx 30rpx rgba(0, 0, 0, 0.2);
  text-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.3);
}

.control-btn:active {
  transform: scale(0.95) translateY(5rpx);
  box-shadow: 0 5rpx 15rpx rgba(0, 0, 0, 0.3);
}

.control-btn.primary {
  background: linear-gradient(135deg, #FF9A76 0%, #FF6B6B 100%);  /* 温暖橙到愤怒红 */
  border: 2rpx solid rgba(255, 255, 255, 0.4);
  box-shadow: 0 15rpx 45rpx rgba(255, 154, 118, 0.5),
              0 0 20rpx rgba(255, 107, 107, 0.3) inset;
}

.control-btn.primary:active {
  box-shadow: 0 8rpx 25rpx rgba(255, 154, 118, 0.6);
}

/* 暴怒模式指示器 */
.rage-indicator {
  position: fixed;
  top: 30rpx;
  left: 50%;
  transform: translateX(-50%);
  padding: 25rpx 50rpx;
  background: linear-gradient(135deg, #FF6B6B 0%, #FF9A76 50%, #FF6B6B 100%);  /* 愤怒红到温暖橙 */
  background-size: 200% 200%;
  border-radius: 50rpx;
  color: #fff;
  font-size: 36rpx;
  font-weight: 900;
  box-shadow: 0 15rpx 50rpx rgba(255, 107, 107, 0.7),
              0 0 30rpx rgba(255, 154, 118, 0.5) inset;
  animation: rage-pulse-enhanced 0.4s ease-in-out infinite alternate,
             rage-gradient 3s ease infinite;
  z-index: 1000;
  border: 2rpx solid rgba(255, 255, 255, 0.5);
  text-shadow: 0 3rpx 10rpx rgba(0, 0, 0, 0.5);
}

@keyframes rage-pulse-enhanced {
  from {
    transform: translateX(-50%) scale(1);
    box-shadow: 0 15rpx 50rpx rgba(255, 107, 107, 0.7),
                0 0 30rpx rgba(255, 154, 118, 0.5) inset;
  }
  to {
    transform: translateX(-50%) scale(1.08);
    box-shadow: 0 20rpx 60rpx rgba(255, 107, 107, 1),
                0 0 40rpx rgba(255, 154, 118, 0.8) inset;
  }
}

@keyframes rage-gradient {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* BGM控制器（已移到导航栏） */
.bgm-control {
  display: none;
}

.bgm-control:active {
  transform: scale(0.9);
  box-shadow: 0 10rpx 30rpx rgba(102, 126, 234, 0.6);
}

.bgm-icon {
  font-size: 48rpx;
  filter: drop-shadow(0 3rpx 8rpx rgba(0, 0, 0, 0.3));
}

/* 设置按钮（已移到导航栏） */
.settings-button {
  display: none;
}

.settings-button text {
  font-size: 40rpx;
  filter: drop-shadow(0 3rpx 8rpx rgba(0, 0, 0, 0.3));
}

.settings-button:active {
  transform: rotate(180deg) scale(0.9);
  box-shadow: 0 10rpx 30rpx rgba(0, 0, 0, 0.3);
}

/* 连击计数器 */
.combo-counter {
  position: absolute;
  top: 120rpx;
  left: 50%;
  transform: translateX(-50%);
  background: linear-gradient(135deg, rgba(255, 234, 167, 0.95) 0%, rgba(253, 203, 110, 0.95) 100%);  /* 亮黄渐变 */
  backdrop-filter: blur(20px);
  padding: 15rpx 40rpx;
  border-radius: 50rpx;
  color: #2D3436;  /* 深灰文字 */
  font-size: 32rpx;
  font-weight: 900;
  box-shadow: 0 10rpx 30rpx rgba(253, 203, 110, 0.5);
  border: 2rpx solid rgba(255, 255, 255, 0.5);
  animation: combo-glow 0.5s ease-in-out infinite alternate;
  text-shadow: none;
}

@keyframes combo-glow {
  from {
    box-shadow: 0 10rpx 30rpx rgba(253, 203, 110, 0.5);
    transform: translateX(-50%) scale(1);
  }
  to {
    box-shadow: 0 15rpx 40rpx rgba(253, 203, 110, 0.8);
    transform: translateX(-50%) scale(1.05);
  }
}

/* ========== 暗黑模式适配 - 高对比度、低压迫感 ========== */
.dark-mode .score-circle {
  /* 深灰色卡片背景(#282828或#1E1E1E)，与背景拉开层次 */
  background: linear-gradient(180deg, #282828 0%, #1E1E1E 100%);
  box-shadow:
    0 16rpx 48rpx rgba(0, 0, 0, 0.5),
    inset 0 2rpx 4rpx rgba(0, 0, 0, 0.3),
    0 0 1rpx rgba(255, 255, 255, 0.1);  /* 发光边框保持立体感 */
}

.dark-mode .score-circle .score-label {
  /* 深色：中灰或浅灰文字 */
  color: #CCCCCC;
}

.dark-mode .score-circle .score-value {
  /* 高亮浅色：明黄#FFE135或浅天蓝#A2E3FC */
  background: linear-gradient(135deg, #FFE135 0%, #A2E3FC 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  filter: drop-shadow(0 0 8rpx rgba(255, 225, 53, 0.5));
}

.dark-mode .section-title {
  /* 深色：纯白或浅灰 */
  color: #FFFFFF;
}

.dark-mode .weapon-card {
  /* 深灰色卡片(#282828) */
  background: linear-gradient(145deg, #282828 0%, #1E1E1E 100%);
  border-color: rgba(255, 255, 255, 0.1);
  box-shadow:
    0 8rpx 24rpx rgba(0, 0, 0, 0.4),
    inset 0 1rpx 0 rgba(255, 255, 255, 0.05);
}

.dark-mode .weapon-card .weapon-name-text {
  /* 深色：纯白 */
  color: #FFFFFF;
}

.dark-mode .weapon-card .weapon-damage-text {
  /* 高亮浅色 */
  color: #FFE135;
  text-shadow: 0 0 6rpx rgba(255, 225, 53, 0.4);
}

.dark-mode .weapon-card.active {
  /* 选中：高亮浅色边框 */
  border-color: #48DBFB;
  background: linear-gradient(145deg, #2D2D2D 0%, #1E1E1E 100%);
  box-shadow:
    0 0 15rpx rgba(72, 219, 251, 0.3),
    0 12rpx 36rpx rgba(0, 0, 0, 0.4),
    inset 0 0 1rpx rgba(72, 219, 251, 0.2);
}

.dark-mode .weapon-card.active .weapon-name-text,
.dark-mode .weapon-card.active .weapon-damage-text {
  color: #A2E3FC;
  text-shadow: 0 0 8rpx rgba(162, 227, 252, 0.5);
}

.dark-mode .controls-simple {
  /* 深色：稍亮深色 */
  background: #333333;
}

.dark-mode .control-icon.primary {
  /* 高亮浅色按钮 */
  background: linear-gradient(135deg, #48DBFB 0%, #A2E3FC 100%);
  box-shadow: 0 0 12rpx rgba(72, 219, 251, 0.4);
}

.dark-mode .current-weapon-badge {
  background: #333333;
}

.dark-mode .weapon-badge-damage {
  color: #FFE135;
  text-shadow: 0 0 6rpx rgba(255, 225, 53, 0.3);
}

/* 旧的暗黑模式样式（保留兼容） */
.dark-mode .score-display {
  background: linear-gradient(135deg, rgba(45, 52, 54, 0.9) 0%, rgba(30, 35, 40, 0.85) 100%);
  border-color: rgba(78, 205, 196, 0.3);
}

.dark-mode .score-label {
  color: #DFE6E9;
}

.dark-mode .score-value {
  background: linear-gradient(135deg, #FFEAA7 0%, #fdcb6e 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.dark-mode .weapon-info,
.dark-mode .control-btn {
  background: linear-gradient(135deg, rgba(45, 52, 54, 0.4) 0%, rgba(30, 35, 40, 0.3) 100%);
  border-color: rgba(78, 205, 196, 0.2);
  box-shadow: 0 10rpx 30rpx rgba(0, 0, 0, 0.5);
}

.dark-mode .control-btn.primary {
  background: linear-gradient(135deg, #4ECDC4 0%, #44A08D 100%);
  box-shadow: 0 15rpx 45rpx rgba(78, 205, 196, 0.5);
}

.dark-mode .bgm-control {
  background: linear-gradient(135deg, rgba(78, 205, 196, 0.9) 0%, rgba(68, 160, 141, 0.9) 100%);
  box-shadow: 0 15rpx 45rpx rgba(78, 205, 196, 0.5);
}

/* ========== 新布局样式 ========== */

/* 主内容区域 */
.main-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  flex: 1;
  padding: 0 var(--spacing-container);
  box-sizing: border-box;
  overflow-y: auto;
  overflow-x: hidden;
}

/* ========== 顶部 HUD - 悬浮分数（无背景框） ========== */
.score-hud {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 100;
  display: flex;
  flex-direction: column;
  align-items: center;
  pointer-events: none;
}

/* 左上角明亮模式按钮（增强可见性） */
.top-left-btn {
  position: absolute;
  top: 0;
  left: var(--spacing-md);
  pointer-events: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 64rpx;
  height: 64rpx;
  z-index: 10;
  transition: all 0.2s ease;
}

.mode-btn-bg {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  /* 浅色主题：白色半透明背景，增强对比度 */
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10rpx);
  -webkit-backdrop-filter: blur(10rpx);
  border-radius: 50%;
  border: 2rpx solid rgba(0, 0, 0, 0.08);
  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);
  transition: all 0.2s ease;
}

.dark-mode .mode-btn-bg {
  /* 深色主题：深灰背景，高对比度 */
  background: rgba(51, 51, 51, 0.95);
  border-color: rgba(255, 255, 255, 0.15);
  box-shadow:
    0 2rpx 8rpx rgba(0, 0, 0, 0.3),
    0 0 0 1rpx rgba(255, 255, 255, 0.1);
}

.top-left-btn:active {
  transform: scale(0.9);
}

.top-left-btn:active .mode-btn-bg {
  background: rgba(0, 122, 255, 0.2);
  border-color: rgba(0, 122, 255, 0.3);
}

.dark-mode .top-left-btn:active .mode-btn-bg {
  background: rgba(72, 219, 251, 0.2);
  border-color: rgba(72, 219, 251, 0.4);
}

.mini-icon {
  font-size: 36rpx;
  position: relative;
  z-index: 1;
  filter: drop-shadow(0 1rpx 2rpx rgba(0, 0, 0, 0.1));
}

/* 右上角武器展示 */
.top-right-weapon {
  position: absolute;
  top: 0;
  right: var(--spacing-md);
  pointer-events: auto;
  display: flex;
  align-items: center;
  gap: 8rpx;
  padding: 8rpx 16rpx;
  z-index: 10;
  transition: all 0.2s ease;
}

.weapon-display-bg {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  /* 浅色主题：白色半透明背景 */
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10rpx);
  -webkit-backdrop-filter: blur(10rpx);
  border-radius: 32rpx;
  border: 2rpx solid rgba(0, 0, 0, 0.08);
  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);
  transition: all 0.2s ease;
}

.dark-mode .weapon-display-bg {
  /* 深色主题：深灰背景 */
  background: rgba(51, 51, 51, 0.95);
  border-color: rgba(255, 255, 255, 0.15);
  box-shadow:
    0 2rpx 8rpx rgba(0, 0, 0, 0.3),
    0 0 0 1rpx rgba(255, 255, 255, 0.1);
}

.top-right-weapon:active {
  transform: scale(0.95);
}

.top-right-weapon:active .weapon-display-bg {
  background: rgba(0, 122, 255, 0.15);
  border-color: rgba(0, 122, 255, 0.25);
}

.dark-mode .top-right-weapon:active .weapon-display-bg {
  background: rgba(72, 219, 251, 0.15);
  border-color: rgba(72, 219, 251, 0.3);
}

.weapon-display-icon {
  font-size: 32rpx;
  position: relative;
  z-index: 1;
  filter: drop-shadow(0 1rpx 2rpx rgba(0, 0, 0, 0.1));
}

.weapon-display-damage {
  font-family: var(--font-number);
  font-size: 24rpx;
  font-weight: 700;
  /* 浅色主题：橙红色伤害值 */
  color: #FF6B3E;
  position: relative;
  z-index: 1;
  text-shadow: 0 1rpx 2rpx rgba(0, 0, 0, 0.1);
}

.dark-mode .weapon-display-damage {
  /* 深色主题：高亮黄色 */
  color: #FFE135;
  text-shadow: 0 0 4rpx rgba(255, 225, 53, 0.3);
}

/* 中央大分数 - 艺术字体效果 */
.score-display {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: var(--spacing-sm);
}

.score-number {
  font-family: var(--font-number);
  font-size: var(--font-size-huge);
  font-weight: 900;
  /* 深色主题：金黄色数值，霓虹发光效果，突出数据 */
  color: #FFD700;
  line-height: 1;
  text-shadow:
    0 0 10rpx rgba(255, 215, 0, 0.8),
    0 0 20rpx rgba(255, 215, 0, 0.6),
    0 0 40rpx rgba(255, 215, 0, 0.4);
  -webkit-text-stroke: 1rpx rgba(255, 215, 0, 0.6);
  letter-spacing: -4rpx;
  animation: score-neon-glow 2s ease-in-out infinite alternate;
}

/* 深色模式下score-number - 已在默认样式中应用 */
.dark-mode .score-number {
  color: #FFD700;
  text-shadow:
    0 0 10rpx rgba(255, 215, 0, 0.8),
    0 0 20rpx rgba(255, 215, 0, 0.6),
    0 0 40rpx rgba(255, 215, 0, 0.4);
  -webkit-text-stroke: 1rpx rgba(255, 215, 0, 0.6);
  animation: score-neon-glow 2s ease-in-out infinite alternate;
}

@keyframes score-neon-glow {
  0% {
    filter: brightness(1);
    text-shadow:
      0 0 10rpx rgba(255, 225, 53, 0.8),
      0 0 20rpx rgba(255, 225, 53, 0.6);
  }
  100% {
    filter: brightness(1.15);
    text-shadow:
      0 0 15rpx rgba(255, 225, 53, 0.9),
      0 0 30rpx rgba(255, 225, 53, 0.7),
      0 0 50rpx rgba(255, 225, 53, 0.5);
  }
}

.score-subtitle {
  font-family: var(--font-title);
  font-size: 24rpx;
  /* 深色：浅灰辅助文字 */
  color: #B8B8B8;
  margin-top: var(--spacing-xs);
}

.dark-mode .score-subtitle {
  /* 深色：浅灰辅助文字 - 已在默认样式中应用 */
  color: #B8B8B8;
}

/* 连击徽章 - 悬浮在分数旁（调整位置避免与武器展示重叠） */
.combo-badge-float {
  position: absolute;
  top: 50%;
  right: calc(var(--spacing-lg) + 140rpx); /* 为右上角武器展示留出空间 */
  transform: translateY(-50%);
  /* 深色：深灰系气泡，金黄边框强调 */
  background: linear-gradient(135deg, #2D2D2D 0%, #1F1F1F 100%);
  padding: var(--spacing-xs) var(--spacing-md);
  border-radius: 30rpx;
  box-shadow:
    0 0 15rpx rgba(255, 215, 0, 0.2),
    0 4rpx 16rpx rgba(0, 0, 0, 0.4);
  border: 1rpx solid rgba(255, 215, 0, 0.4);
  animation: combo-bounce 0.3s ease-out;
  z-index: 9;
}

.combo-x {
  font-family: var(--font-number);
  font-size: 32rpx;
  font-weight: 900;
  /* 深色：高亮浅色文字 */
  background: linear-gradient(135deg, #FFD700 0%, #00D4FF 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  filter: drop-shadow(0 0 4rpx rgba(255, 215, 0, 0.5));
}

/* 深色模式连击徽章 - 已在默认样式中应用 */
.dark-mode .combo-badge-float {
  background: linear-gradient(135deg, #2D2D2D 0%, #1F1F1F 100%);
  border: 1rpx solid rgba(255, 215, 0, 0.4);
  box-shadow:
    0 0 15rpx rgba(255, 215, 0, 0.2),
    0 4rpx 16rpx rgba(0, 0, 0, 0.4);
}

.dark-mode .combo-x {
  /* 深色：高亮浅色文字 - 已在默认样式中应用 */
  background: linear-gradient(135deg, #FFD700 0%, #00D4FF 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  filter: drop-shadow(0 0 4rpx rgba(255, 215, 0, 0.5));
}

@keyframes combo-bounce {
  0% { transform: translateY(-50%) scale(0.5); }
  60% { transform: translateY(-50%) scale(1.2); }
  100% { transform: translateY(-50%) scale(1); }
}

/* 暴怒模式指示器 - 悬浮 */
.rage-indicator-float {
  position: fixed;
  top: 180rpx;
  left: 50%;
  transform: translateX(-50%);
  z-index: 101;
  font-size: 28rpx;
  font-weight: 700;
  color: #fff;
  background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);
  padding: var(--spacing-xs) var(--spacing-md);
  border-radius: 30rpx;
  box-shadow: 0 4rpx 20rpx rgba(255, 107, 107, 0.5);
  animation: rage-pulse 0.5s ease-in-out infinite alternate;
}

@keyframes rage-pulse {
  0% { transform: translateX(-50%) scale(1); box-shadow: 0 4rpx 20rpx rgba(255, 107, 107, 0.5); }
  100% { transform: translateX(-50%) scale(1.05); box-shadow: 0 6rpx 30rpx rgba(255, 107, 107, 0.7); }
}

/* 连击动态飘字（替代红色矩形框） */
.combo-float-text {
  position: fixed;
  top: 35%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.5);
  z-index: 500;
  opacity: 0;
  pointer-events: none;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.combo-float-text.show {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}

.combo-text-main {
  display: block;
  font-family: var(--font-number);
  font-size: 52rpx;
  font-weight: 900;
  font-style: italic;
  color: #fff;
  /* 浅色主题：漫画气泡字体，橙红渐变 */
  background: linear-gradient(135deg, #FF6B3E 0%, #FF4757 50%, #FF6B3E 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: none;
  filter: drop-shadow(3rpx 3rpx 0 #C0392B) drop-shadow(0 6rpx 12rpx rgba(0, 0, 0, 0.3));
  animation: combo-text-shake 0.1s ease-in-out 3;
  /* 倾斜漫画风格 */
  transform: skewX(-5deg);
}

@keyframes combo-text-shake {
  0%, 100% { transform: skewX(-5deg) rotate(-2deg); }
  50% { transform: skewX(-5deg) rotate(2deg); }
}

/* 深色模式连击 - 尖锐机械/科幻字体，高亮发光 */
.dark-mode .combo-text-main {
  /* 霓虹橙/荧光绿效果 */
  background: linear-gradient(135deg, #FFA500 0%, #00FF88 50%, #FFA500 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  filter:
    drop-shadow(0 0 8rpx #FFA500)
    drop-shadow(0 0 16rpx rgba(255, 165, 0, 0.6))
    drop-shadow(0 0 32rpx rgba(0, 255, 136, 0.4));
  animation: combo-neon-shake 0.1s ease-in-out 3;
  transform: skewX(-8deg); /* 更尖锐的倾斜 */
}

@keyframes combo-neon-shake {
  0%, 100% { transform: skewX(-8deg) rotate(-3deg) scale(1); }
  50% { transform: skewX(-8deg) rotate(3deg) scale(1.05); }
}

/* 隐藏旧的分数卡片 */
.score-card {
  display: none;
}

/* 隐藏旧的连击结果 */
.combo-result {
  display: none;
}

/* 隐藏旧的暴怒指示器 */
.rage-indicator {
  display: none;
}

/* 武器区域头部 */
.section-header {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: var(--spacing-sm);
}

.section-header .section-title {
  font-family: var(--font-title);
  font-size: var(--font-size-title);
  font-weight: 600;
  color: var(--color-text);
  margin-bottom: var(--spacing-xs);
}

.current-weapon-info {
  font-family: var(--font-title);
  font-size: var(--font-size-small);
  color: var(--color-primary);
  font-weight: 400;
}

/* 紧凑武器卡片 */
.weapons-section .weapon-card {
  width: 140rpx;
  min-width: 140rpx;
  padding: var(--spacing-sm) var(--spacing-xs);
}

.weapons-section .weapon-icon {
  font-size: 48rpx;
  margin-bottom: var(--spacing-xs);
}

.weapons-section .weapon-damage-text {
  font-family: var(--font-number);
  font-size: var(--font-size-body);
  color: var(--color-text);
  font-weight: 700;
}

.weapons-section .weapon-card.active .weapon-damage-text {
  color: #fff;
}

/* 主操作按钮区域 */
.main-action-area {
  width: 100%;
  padding: var(--spacing-sm) 0;
}

.main-action-btn {
  width: 100%;
  background: linear-gradient(135deg, var(--color-danger) 0%, var(--color-accent) 100%);
  border-radius: var(--spacing-sm);
  padding: var(--spacing-md) var(--spacing-lg);
  display: flex;
  flex-direction: column;
  align-items: center;
  box-shadow: 0 8rpx 24rpx rgba(255, 107, 107, 0.4);
  transition: transform 0.05s ease, box-shadow 0.05s ease;
  transform-origin: center center;
}

/* 点击瞬间按钮缩小到0.95倍 */
.main-action-btn.pressed {
  transform: scale(0.95);
  box-shadow: 0 4rpx 12rpx rgba(255, 107, 107, 0.6);
}

.main-action-btn:active {
  transform: scale(0.95);
  box-shadow: 0 4rpx 12rpx rgba(255, 107, 107, 0.6);
}

.action-icon {
  font-size: 48rpx;
  margin-bottom: var(--spacing-xs);
  transition: transform 0.1s ease;
}

.main-action-btn.pressed .action-icon {
  transform: scale(1.2);
}

.action-text {
  font-family: var(--font-title);
  font-size: var(--font-size-title);
  font-weight: 600;
  color: #fff;
}

.action-hint {
  font-family: var(--font-title);
  font-size: var(--font-size-small);
  color: rgba(255, 255, 255, 0.8);
  font-weight: 300;
  margin-top: var(--spacing-xs);
}

/* 底部操作栏 */
.bottom-actions {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-sm) 0;
  padding-bottom: calc(var(--spacing-lg) + env(safe-area-inset-bottom, 16rpx));
  width: 100%;
}

.action-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-xs);
  padding: var(--spacing-sm) var(--spacing-md);
  background: rgba(45, 52, 54, 0.9);
  border-radius: var(--spacing-sm);
  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.4);
  border: 1rpx solid rgba(255, 255, 255, 0.1);
  transition: all 0.2s ease;
}

.action-btn.secondary {
  flex: 1;
  max-width: 240rpx;
}

.action-btn:active {
  transform: scale(0.95);
  background: rgba(45, 52, 54, 1);
}

.btn-icon {
  font-size: 32rpx;
  color: var(--color-primary);
}

.btn-text {
  font-family: var(--font-title);
  font-size: var(--font-size-small);
  color: #fff;
  font-weight: 400;
}

/* 隐藏旧样式 */
.score-circle,
.current-weapon-badge,
.controls-simple {
  display: none;
}

/* ========== 暗黑模式新布局适配 ========== */
.dark-mode .score-card {
  background: rgba(45, 52, 54, 0.9);
}

.dark-mode .score-card .score-label {
  color: var(--color-text-light);
}

.dark-mode .score-card .score-value {
  color: var(--color-highlight);
}

.dark-mode .today-label {
  color: var(--color-primary);
}

.dark-mode .section-header .section-title {
  color: var(--color-text-light);
}

.dark-mode .current-weapon-info {
  color: var(--color-primary);
}

.dark-mode .action-btn {
  background: rgba(45, 52, 54, 0.9);
}

.dark-mode .btn-text {
  color: var(--color-text-light);
}

/* ========== 武器选择触发按钮 - 豪华风格 ========== */
.weapon-trigger {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: linear-gradient(135deg, rgba(26, 26, 46, 0.95) 0%, rgba(45, 52, 54, 0.9) 100%);
  border-radius: 20rpx;
  padding: var(--spacing-sm) var(--spacing-md);
  margin-bottom: var(--spacing-sm);
  box-shadow:
    0 4rpx 16rpx rgba(0, 0, 0, 0.2),
    inset 0 1rpx 0 rgba(255, 255, 255, 0.1);
  border: 2rpx solid rgba(255, 255, 255, 0.1);
}

.current-weapon-display {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.weapon-emoji {
  font-size: 56rpx;
  filter: drop-shadow(0 4rpx 8rpx rgba(0,0,0,0.3));
}

.weapon-info {
  display: flex;
  flex-direction: column;
}

.weapon-name {
  font-family: var(--font-title);
  font-size: var(--font-size-body);
  font-weight: 600;
  color: #fff;
}

.weapon-dmg {
  font-family: var(--font-number);
  font-size: var(--font-size-small);
  color: var(--color-danger);
  font-weight: 600;
}

.change-weapon-btn {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
  background: linear-gradient(135deg, #FFD700 0%, #FFA000 100%);
  padding: var(--spacing-xs) var(--spacing-md);
  border-radius: 12rpx;
  box-shadow: 0 4rpx 12rpx rgba(255, 215, 0, 0.3);
}

.change-icon {
  font-size: 24rpx;
}

.change-text {
  font-family: var(--font-title);
  font-size: var(--font-size-small);
  color: #1a1a2e;
  font-weight: 600;
}

/* ========== 武器选择面板 - 豪华卡牌风格 ========== */
.weapon-panel-mask {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 2000;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  /* 全屏磨砂玻璃背景 */
  backdrop-filter: blur(20rpx);
  -webkit-backdrop-filter: blur(20rpx);
  pointer-events: auto;
}

.weapon-panel-mask.show {
  opacity: 1;
  visibility: visible;
}

.weapon-panel {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  height: 70vh;
  /* 深色主题：深灰背景，专业沉浸 */
  background: #1A1A1A;
  backdrop-filter: blur(30rpx);
  -webkit-backdrop-filter: blur(30rpx);
  border-radius: 40rpx 40rpx 0 0;
  z-index: 2001;
  display: flex;
  flex-direction: column;
  transform: translateY(100%);
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  pointer-events: auto;
  box-shadow:
    inset 0 1rpx 0 rgba(255, 255, 255, 0.05),
    0 -8rpx 32rpx rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

/* 深色模式武器面板 - 深灰背景，避免压迫感 */
.dark-mode .weapon-panel {
  background: #1A1A1A;
  box-shadow:
    inset 0 1rpx 0 rgba(255, 255, 255, 0.05),
    0 -8rpx 32rpx rgba(0, 0, 0, 0.5);
}

.dark-mode .weapon-panel-mask {
  background: rgba(0, 0, 0, 0.6);
}

.weapon-panel.show {
  transform: translateY(0);
}

/* 面板头部 */
.panel-header {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: var(--spacing-md) var(--spacing-md) var(--spacing-sm);
  /* 深色：科技感暗纹理 */
  background: linear-gradient(180deg, #2D2D2D 0%, #1A1A1A 100%);
}

/* 深色模式面板头部 - 科技感暗纹理 */
.dark-mode .panel-header {
  background: linear-gradient(180deg, #2D2D2D 0%, #1A1A1A 100%);
}

.panel-drag-indicator {
  width: 60rpx;
  height: 6rpx;
  background: rgba(0, 0, 0, 0.15);
  border-radius: 3rpx;
  margin-bottom: var(--spacing-sm);
}

.dark-mode .panel-drag-indicator {
  background: rgba(255, 255, 255, 0.2);
}

.panel-title {
  font-family: var(--font-title);
  font-size: 40rpx;
  font-weight: 700;
  /* 深色：纯白文字 */
  color: #FFFFFF;
  text-shadow: none;
}

/* 深色模式标题 */
.dark-mode .panel-title {
  /* 深色：纯白文字 - 已在默认样式中应用 */
  color: #FFFFFF;
  text-shadow: none;
}

.panel-subtitle {
  font-family: var(--font-title);
  font-size: var(--font-size-small);
  /* 深色：浅灰辅助文字 */
  color: #B8B8B8;
  margin-top: 4rpx;
}

.dark-mode .panel-subtitle {
  /* 深色：浅灰辅助文字 - 已在默认样式中应用 */
  color: #B8B8B8;
}

/* 卡牌轮播区域 */
.card-carousel {
  flex: 1;
  padding: var(--spacing-md) 0;
  white-space: nowrap;
}

/* 武器卡牌包装器 */
.weapon-card-wrapper {
  display: inline-block;
  vertical-align: top;
  margin: 0 var(--spacing-sm);
  padding: var(--spacing-sm) 0;
}

.weapon-card-wrapper:first-child {
  margin-left: var(--spacing-md);
}

/* ========== 集换式卡牌设计 ========== */
/* 深色主题：深灰科技风卡片 */
.weapon-card {
  position: relative;
  width: 280rpx;
  height: 420rpx;
  /* 深色：深灰底色，橙色边框强调 */
  background: linear-gradient(145deg, #282828 0%, #1E1E1E 100%);
  border-radius: 24rpx;
  padding: var(--spacing-sm);
  display: flex;
  flex-direction: column;
  align-items: center;
  box-sizing: border-box;
  overflow: hidden;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  border: 3rpx solid rgba(255, 165, 0, 0.15);
  box-shadow:
    0 8rpx 24rpx rgba(0, 0, 0, 0.4),
    0 0 1rpx rgba(255, 165, 0, 0.1);
}

/* 深色模式武器卡片 - 已在默认样式中应用 */
.dark-mode .weapon-card {
  background: linear-gradient(145deg, #282828 0%, #1E1E1E 100%);
  border-color: rgba(255, 165, 0, 0.15);
  box-shadow:
    0 8rpx 24rpx rgba(0, 0, 0, 0.4),
    0 0 1rpx rgba(255, 165, 0, 0.1);
}

/* 选中状态 - 霓虹橙发光边框 */
.weapon-card.selected {
  border: 4rpx solid #FFA500;
  box-shadow:
    0 0 15rpx rgba(255, 165, 0, 0.5),
    0 0 30rpx rgba(255, 165, 0, 0.2),
    0 12rpx 32rpx rgba(0, 0, 0, 0.4);
  transform: translateY(-8rpx);
}

/* 深色模式选中状态 - 已在默认样式中应用 */
.dark-mode .weapon-card.selected {
  border: 4rpx solid #FFA500;
  box-shadow:
    0 0 15rpx rgba(255, 165, 0, 0.5),
    0 0 30rpx rgba(255, 165, 0, 0.2),
    0 12rpx 32rpx rgba(0, 0, 0, 0.4);
  transform: translateY(-8rpx);
}

.weapon-card:active {
  transform: scale(0.96);
}

/* 卡牌光效边框 */
.card-glow {
  position: absolute;
  top: -2rpx;
  left: -2rpx;
  right: -2rpx;
  bottom: -2rpx;
  border-radius: 26rpx;
  background: linear-gradient(135deg, var(--card-color) 0%, transparent 50%, var(--card-color) 100%);
  opacity: 0.5;
  z-index: 0;
  animation: glow-rotate 3s linear infinite;
}

.card-glow.legendary {
  opacity: 0.8;
  animation: glow-pulse 2s ease-in-out infinite;
}

@keyframes glow-rotate {
  0% { filter: hue-rotate(0deg); }
  100% { filter: hue-rotate(360deg); }
}

@keyframes glow-pulse {
  0%, 100% { opacity: 0.6; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.02); }
}

/* 稀有度颜色 */
.weapon-card.rarity-common {
  border-color: #9E9E9E;
}
.weapon-card.rarity-uncommon {
  border-color: #4CAF50;
}
.weapon-card.rarity-rare {
  border-color: #9C27B0;
}
.weapon-card.rarity-epic {
  border-color: #FF9800;
}
.weapon-card.rarity-legendary {
  border-color: #F44336;
  background: linear-gradient(145deg, #3d1f1f 0%, #1a1a2e 100%);
}
.weapon-card.rarity-mythic {
  border-color: #FFD700;
  background: linear-gradient(145deg, #3d3d1f 0%, #1a1a2e 100%);
}

/* 选中状态 */
.weapon-card.selected {
  border-color: var(--color-primary) !important;
  box-shadow: 0 0 30rpx rgba(78, 205, 196, 0.5);
  transform: scale(1.02);
}

/* 稀有度标签 */
.rarity-badge {
  position: absolute;
  top: var(--spacing-sm);
  right: var(--spacing-sm);
  padding: 4rpx 12rpx;
  border-radius: 8rpx;
  font-family: var(--font-title);
  font-size: 18rpx;
  font-weight: 600;
  z-index: 2;
}

.rarity-badge.rarity-common {
  background: #9E9E9E;
  color: #fff;
}
.rarity-badge.rarity-uncommon {
  background: linear-gradient(135deg, #4CAF50, #2E7D32);
  color: #fff;
}
.rarity-badge.rarity-rare {
  background: linear-gradient(135deg, #9C27B0, #6A1B9A);
  color: #fff;
}
.rarity-badge.rarity-epic {
  background: linear-gradient(135deg, #FF9800, #E65100);
  color: #fff;
}
.rarity-badge.rarity-legendary {
  background: linear-gradient(135deg, #F44336, #B71C1C);
  color: #fff;
  animation: badge-pulse 1.5s ease-in-out infinite;
}
.rarity-badge.rarity-mythic {
  background: linear-gradient(135deg, #FFD700, #FFA000);
  color: #1a1a2e;
  animation: badge-pulse 1.5s ease-in-out infinite;
}

@keyframes badge-pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

/* 武器图标区 */
.card-icon-area {
  width: 140rpx;
  height: 140rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: var(--spacing-sm) 0;
  z-index: 1;
}

.weapon-icon-3d {
  width: 120rpx;
  height: 120rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 70%);
  border-radius: 50%;
  box-shadow:
    0 8rpx 24rpx rgba(0,0,0,0.3),
    inset 0 2rpx 8rpx rgba(255,255,255,0.1);
  position: relative;
}

.weapon-icon-3d::before {
  content: '';
  position: absolute;
  top: -10rpx;
  left: -10rpx;
  right: -10rpx;
  bottom: -10rpx;
  border-radius: 50%;
  background: radial-gradient(circle, var(--card-color) 0%, transparent 70%);
  opacity: 0.3;
  z-index: -1;
}

.weapon-icon-3d.legendary::before {
  animation: icon-glow 2s ease-in-out infinite;
}

@keyframes icon-glow {
  0%, 100% { opacity: 0.3; transform: scale(1); }
  50% { opacity: 0.6; transform: scale(1.1); }
}

.weapon-main-icon {
  font-size: 64rpx;
  filter: drop-shadow(0 4rpx 8rpx rgba(0,0,0,0.3));
}

/* 武器名称 */
.card-weapon-name {
  font-family: var(--font-title);
  font-size: var(--font-size-body);
  font-weight: 600;
  color: #fff;
  text-align: center;
  margin-bottom: var(--spacing-xs);
  z-index: 1;
}

/* 属性星级 */
.card-stats {
  width: 100%;
  padding: 0 var(--spacing-xs);
  z-index: 1;
}

.stat-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 4rpx;
}

.stat-label {
  font-family: var(--font-title);
  font-size: 20rpx;
  color: rgba(255,255,255,0.6);
}

.stat-stars {
  display: flex;
  gap: 2rpx;
}

.stat-stars .star {
  font-size: 18rpx;
  color: rgba(255,255,255,0.2);
}

.stat-stars .star.filled {
  color: #FFD700;
  text-shadow: 0 0 8rpx rgba(255, 215, 0, 0.5);
}

/* 伤害数值 */
.card-damage {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: var(--spacing-xs) 0;
  padding: var(--spacing-xs) var(--spacing-sm);
  background: rgba(255,255,255,0.1);
  border-radius: 12rpx;
  z-index: 1;
}

.card-damage.legendary {
  background: linear-gradient(135deg, rgba(244, 67, 54, 0.3), rgba(255, 152, 0, 0.3));
}

.damage-value {
  font-family: var(--font-number);
  font-size: 36rpx;
  font-weight: 700;
  color: var(--color-danger);
  line-height: 1;
}

.card-damage.legendary .damage-value {
  color: #FFD700;
  text-shadow: 0 0 12rpx rgba(255, 215, 0, 0.5);
}

.damage-label {
  font-family: var(--font-title);
  font-size: 18rpx;
  color: rgba(255,255,255,0.5);
}

/* 描述文字 */
.card-description {
  font-family: var(--font-title);
  font-size: 18rpx;
  color: rgba(255,255,255,0.4);
  text-align: center;
  line-height: 1.4;
  padding: 0 var(--spacing-xs);
  white-space: normal;
  z-index: 1;
}

/* 装备中标记 */
.equipped-badge {
  position: absolute;
  bottom: var(--spacing-sm);
  left: 50%;
  transform: translateX(-50%);
  background: linear-gradient(135deg, var(--color-primary), #2E7D32);
  padding: 6rpx 16rpx;
  border-radius: 12rpx;
  z-index: 3;
}

.equipped-badge.legendary {
  background: linear-gradient(135deg, #FFD700, #FFA000);
}

.equipped-badge text {
  font-family: var(--font-title);
  font-size: 20rpx;
  font-weight: 600;
  color: #fff;
}

.equipped-badge.legendary text {
  color: #1a1a2e;
}

/* 锁定遮罩 */
.card-lock-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  border-radius: 24rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
  backdrop-filter: blur(4rpx);
}

.card-lock-overlay.legendary {
  background: rgba(26, 26, 46, 0.9);
}

.lock-content {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.lock-icon-big {
  font-size: 48rpx;
  margin-bottom: var(--spacing-xs);
}

.lock-requirement {
  font-family: var(--font-title);
  font-size: 22rpx;
  color: rgba(255,255,255,0.8);
  text-align: center;
  padding: 0 var(--spacing-sm);
}

/* 分隔线 */
.card-divider {
  display: inline-flex;
  align-items: center;
  vertical-align: middle;
  padding: 0 var(--spacing-md);
  height: 420rpx;
}

.divider-line {
  width: 2rpx;
  height: 120rpx;
  background: linear-gradient(180deg, transparent, rgba(255,215,0,0.5), transparent);
}

.divider-text {
  font-family: var(--font-title);
  font-size: 24rpx;
  font-weight: 600;
  color: #FFD700;
  writing-mode: vertical-rl;
  text-orientation: mixed;
  padding: var(--spacing-sm) 0;
  text-shadow: 0 0 12rpx rgba(255, 215, 0, 0.5);
}

/* 面板底部 */
.panel-footer {
  padding: var(--spacing-sm) var(--spacing-md);
  padding-bottom: calc(var(--spacing-sm) + env(safe-area-inset-bottom, 16rpx));
  background: transparent;
}

.close-panel-btn {
  width: 100%;
  text-align: center;
  padding: var(--spacing-md) 0;
  /* 浅色主题：品牌警示红(#E53935)，确保关键操作醒目 */
  background: linear-gradient(135deg, #E53935 0%, #FF5252 100%);
  border-radius: 30rpx;
  color: #fff;
  font-family: var(--font-title);
  font-size: 32rpx;
  font-weight: 700;
  box-shadow: 0 6rpx 20rpx rgba(229, 57, 53, 0.35);
  transition: all 0.2s ease;
}

.close-panel-btn:active {
  opacity: 0.9;
  transform: scale(0.98);
  box-shadow: 0 3rpx 12rpx rgba(229, 57, 53, 0.4);
}

/* 深色模式关闭按钮 - 低饱和暗色+亮边，避免"消失"问题 */
.dark-mode .close-panel-btn {
  /* #555555背景 + 白色描边，或#8B0000背景 + 浅红图标 */
  background: linear-gradient(135deg, #8B0000 0%, #B71C1C 100%);
  border: 1rpx solid rgba(255, 255, 255, 0.2);
  box-shadow:
    0 0 10rpx rgba(255, 68, 68, 0.2),
    0 6rpx 20rpx rgba(0, 0, 0, 0.4);
}

.dark-mode .close-panel-btn:active {
  /* 悬停/点击反馈：暗色背景+亮色图标 */
  background: linear-gradient(135deg, #444444 0%, #555555 100%);
  color: #FF4444;
  box-shadow:
    0 0 15rpx rgba(255, 68, 68, 0.3),
    0 3rpx 12rpx rgba(0, 0, 0, 0.5);
}

/* ========== 浮现武器效果 ========== */
.floating-weapon {
  position: absolute;
  top: -40rpx;
  right: -20rpx;
  z-index: 5;
  transform: rotate(30deg);
  filter: drop-shadow(0 8rpx 16rpx rgba(0,0,0,0.3));
}

.floating-weapon-icon {
  font-size: 80rpx;
}

.floating-weapon.weapon-swing {
  animation: weapon-swing 0.3s ease-out;
}

@keyframes weapon-swing {
  0% { transform: rotate(30deg); }
  30% { transform: rotate(-30deg) scale(1.2); }
  60% { transform: rotate(15deg) scale(1.1); }
  100% { transform: rotate(30deg) scale(1); }
}

/* ========== 暗黑模式武器面板适配（面板本身已是暗色） ========== */
.dark-mode .weapon-trigger {
  background: rgba(45, 52, 54, 0.95);
}

.dark-mode .weapon-name {
  color: var(--color-text-light);
}

/* ========== 底部悬浮 Dock 栏 - iOS风格毛玻璃 ========== */
.floating-toolbar {
  display: none; /* 隐藏旧工具栏 */
}

.floating-dock {
  position: fixed;
  bottom: calc(20rpx + env(safe-area-inset-bottom, 16rpx));
  left: 50%;
  transform: translateX(-50%);
  z-index: 100;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 16rpx;
  padding: 18rpx 28rpx;
  /* 高级毛玻璃效果 - 深灰半透明 */
  background: rgba(30, 30, 30, 0.75);
  backdrop-filter: blur(30rpx) saturate(180%);
  -webkit-backdrop-filter: blur(30rpx) saturate(180%);
  border-radius: 60rpx;
  border: 1.5rpx solid rgba(255, 255, 255, 0.2);
  box-shadow:
    /* 外部阴影 - 深度感 */
    0 8rpx 32rpx rgba(0, 0, 0, 0.4),
    0 2rpx 8rpx rgba(0, 0, 0, 0.25),
    /* 内部高光 - 质感 */
    inset 0 1rpx 2rpx rgba(255, 255, 255, 0.15),
    inset 0 -1rpx 2rpx rgba(0, 0, 0, 0.2);
  transition: all 0.3s ease;
}

.dock-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8rpx;
  padding: 12rpx 14rpx;
  border-radius: 20rpx;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  cursor: pointer;
  position: relative;
}

.dock-item:hover {
  transform: translateY(-4rpx);
}

.dock-item:active {
  transform: scale(0.85) translateY(-2rpx);
}

/* 选中状态的Dock项 */
.dock-item.active .dock-icon-wrap {
  background: linear-gradient(135deg, rgba(72, 219, 251, 0.4) 0%, rgba(168, 227, 252, 0.3) 100%);
  border-color: rgba(72, 219, 251, 0.5);
  box-shadow:
    inset 0 1rpx 2rpx rgba(255, 255, 255, 0.2),
    inset 0 -1rpx 2rpx rgba(0, 0, 0, 0.1),
    0 0 20rpx rgba(72, 219, 251, 0.4),
    0 4rpx 16rpx rgba(72, 219, 251, 0.2);
}

.dock-item.active .dock-label {
  color: #48DBFB;
  text-shadow: 0 0 8rpx rgba(72, 219, 251, 0.5);
  opacity: 1;
}

.dock-icon-wrap {
  width: 60rpx;
  height: 60rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  /* 深色背景圆形按钮 - 增强质感 */
  background: rgba(100, 100, 100, 0.25);
  border-radius: 18rpx;
  border: 1rpx solid rgba(255, 255, 255, 0.1);
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow:
    inset 0 1rpx 2rpx rgba(255, 255, 255, 0.08),
    inset 0 -1rpx 2rpx rgba(0, 0, 0, 0.1);
}

.dock-item:active .dock-icon-wrap {
  background: rgba(72, 219, 251, 0.3);
  border-color: rgba(72, 219, 251, 0.4);
  transform: scale(1.15);
  box-shadow:
    inset 0 1rpx 2rpx rgba(255, 255, 255, 0.15),
    inset 0 -1rpx 2rpx rgba(0, 0, 0, 0.15),
    0 0 16rpx rgba(72, 219, 251, 0.3);
}

.dock-icon {
  font-size: 30rpx;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  text-shadow: 0 2rpx 4rpx rgba(0, 0, 0, 0.3);
}

.dock-label {
  font-family: var(--font-title);
  font-size: 16rpx;
  /* 深色主题文字：浅灰色 */
  color: #D0D0D0;
  font-weight: 500;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  letter-spacing: 0.5rpx;
}

/* ========== 深色模式 Dock 栏 - 高对比度、低压迫感 ========== */
.dark-mode .floating-dock {
  /* 深色：深色背景，增强质感 */
  background: rgba(20, 20, 20, 0.8);
  border-color: rgba(255, 255, 255, 0.15);
  box-shadow:
    /* 外部阴影 - 深度感 */
    0 8rpx 32rpx rgba(0, 0, 0, 0.5),
    0 2rpx 8rpx rgba(0, 0, 0, 0.3),
    /* 内部高光 - 质感 */
    inset 0 1rpx 2rpx rgba(255, 255, 255, 0.12),
    inset 0 -1rpx 2rpx rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(30rpx) saturate(180%);
  -webkit-backdrop-filter: blur(30rpx) saturate(180%);
}

.dark-mode .dock-icon-wrap {
  background: rgba(80, 80, 80, 0.25);
  border-color: rgba(255, 255, 255, 0.08);
  box-shadow:
    inset 0 1rpx 2rpx rgba(255, 255, 255, 0.1),
    inset 0 -1rpx 2rpx rgba(0, 0, 0, 0.2);
}

.dark-mode .dock-item.active .dock-icon-wrap {
  /* 深色选中：高亮浅色 */
  background: linear-gradient(135deg, rgba(72, 219, 251, 0.45) 0%, rgba(168, 227, 252, 0.35) 100%);
  border-color: rgba(72, 219, 251, 0.6);
  box-shadow:
    inset 0 1rpx 2rpx rgba(255, 255, 255, 0.2),
    inset 0 -1rpx 2rpx rgba(0, 0, 0, 0.15),
    0 0 24rpx rgba(72, 219, 251, 0.45),
    0 4rpx 16rpx rgba(72, 219, 251, 0.25);
}

.dark-mode .dock-item.active .dock-label {
  color: #4FE3FF;
  text-shadow: 0 0 12rpx rgba(72, 219, 251, 0.6);
}

.dark-mode .dock-item:active .dock-icon-wrap {
  background: rgba(72, 219, 251, 0.35);
  border-color: rgba(72, 219, 251, 0.5);
}

.dark-mode .dock-label {
  /* 深色：浅灰文字 */
  color: #E0E0E0;
  text-shadow: 0 1rpx 2rpx rgba(0, 0, 0, 0.4);
}

/* ========== 设置弹出菜单 ========== */
.settings-menu-mask {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.3);
  z-index: 150;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

.settings-menu-mask.show {
  opacity: 1;
  pointer-events: auto;
}

.settings-menu {
  position: fixed;
  bottom: calc(140rpx + env(safe-area-inset-bottom, 16rpx));
  left: 50%;
  transform: translateX(-50%) scale(0.8);
  z-index: 160;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xs);
  padding: var(--spacing-sm);
  /* 浅色主题：纯白背景 */
  background: rgba(255, 255, 255, 0.98);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border-radius: var(--spacing-md);
  border: 1rpx solid #E5E5E5;
  box-shadow: 0 8rpx 32rpx rgba(0, 0, 0, 0.12);
  opacity: 0;
  pointer-events: none;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.settings-menu.show {
  opacity: 1;
  pointer-events: auto;
  transform: translateX(-50%) scale(1);
}

.settings-item {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-sm) var(--spacing-md);
  /* 浅色：极浅灰背景 */
  background: #F8F8F8;
  border-radius: var(--spacing-sm);
  transition: all 0.2s ease;
  min-width: 240rpx;
}

.settings-item:active {
  background: rgba(0, 122, 255, 0.1);
  transform: scale(0.98);
}

.settings-icon {
  font-size: 28rpx;
}

.settings-text {
  font-family: var(--font-title);
  font-size: var(--font-size-body);
  /* 浅色：深灰文字 */
  color: #333333;
  font-weight: 500;
}

/* ========== 暗黑模式设置菜单 - 高对比度、低压迫感 ========== */
.dark-mode .settings-menu {
  /* 深色：稍亮深色背景(#333333) */
  background: rgba(51, 51, 51, 0.98);
  border-color: rgba(255, 255, 255, 0.1);
  box-shadow:
    inset 0 1rpx 0 rgba(255, 255, 255, 0.05),
    0 8rpx 32rpx rgba(0, 0, 0, 0.5);
}

.dark-mode .settings-item {
  /* 深色：更深的背景 */
  background: #2D2D2D;
  border: none;
}

.dark-mode .settings-item:active {
  background: rgba(72, 219, 251, 0.15);
}

.dark-mode .settings-text {
  /* 深色：纯白或浅灰 */
  color: #FFFFFF;
}

/* ========== 成就荣誉墙面板 ========== */
.achievement-panel-mask {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.6);
  z-index: 800;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

.achievement-panel-mask.show {
  opacity: 1;
  pointer-events: auto;
}

.achievement-panel {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 75vh;
  background: linear-gradient(180deg, #2D3436 0%, #1e272e 100%);
  border-radius: var(--spacing-lg) var(--spacing-lg) 0 0;
  z-index: 850;
  transform: translateY(100%);
  transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  pointer-events: auto;
}

.achievement-panel.show {
  transform: translateY(0);
}

.achievement-header {
  padding: var(--spacing-md) var(--spacing-lg);
  text-align: center;
  background: linear-gradient(180deg, rgba(255,215,0,0.1) 0%, transparent 100%);
}

.achievement-title {
  display: block;
  font-family: var(--font-title);
  font-size: 40rpx;
  font-weight: 700;
  color: #FFD700;
  text-shadow: 0 0 20rpx rgba(255, 215, 0, 0.5);
  margin-bottom: var(--spacing-xs);
}

.achievement-subtitle {
  display: block;
  font-size: var(--font-size-small);
  color: rgba(255, 255, 255, 0.6);
}

/* 奖杯架 */
.trophy-shelf {
  flex: 1;
  padding: var(--spacing-sm) var(--spacing-md);
  overflow-y: auto;
}

.trophy-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--spacing-md);
  padding-bottom: var(--spacing-lg);
}

.trophy-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: var(--spacing-md) var(--spacing-sm);
  background: rgba(255, 255, 255, 0.05);
  border-radius: var(--spacing-sm);
  border: 2rpx solid rgba(255, 255, 255, 0.1);
  transition: all 0.3s ease;
}

.trophy-item.unlocked {
  background: linear-gradient(180deg, rgba(255, 215, 0, 0.15) 0%, rgba(255, 215, 0, 0.05) 100%);
  border-color: rgba(255, 215, 0, 0.3);
}

.trophy-item.locked {
  opacity: 0.6;
}

/* 奖杯底座 */
.trophy-pedestal {
  position: relative;
  width: 80rpx;
  height: 80rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: var(--spacing-xs);
}

.trophy-display {
  position: relative;
  z-index: 2;
}

.trophy-icon {
  font-size: 48rpx;
  transition: all 0.3s ease;
}

.trophy-icon.silhouette {
  filter: brightness(0) opacity(0.3);
}

/* 解锁光芒 */
.trophy-glow {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100rpx;
  height: 100rpx;
  background: radial-gradient(circle, rgba(255, 215, 0, 0.4) 0%, transparent 70%);
  border-radius: 50%;
  animation: trophy-glow-pulse 2s ease-in-out infinite;
  z-index: 1;
}

@keyframes trophy-glow-pulse {
  0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.6; }
  50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
}

/* 锁定图标 */
.trophy-lock {
  position: absolute;
  bottom: -8rpx;
  right: -8rpx;
  width: 32rpx;
  height: 32rpx;
  background: rgba(0, 0, 0, 0.7);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 3;
}

.trophy-lock .lock-icon {
  font-size: 16rpx;
}

/* 奖杯信息 */
.trophy-info {
  text-align: center;
}

.trophy-name {
  display: block;
  font-family: var(--font-title);
  font-size: 22rpx;
  font-weight: 600;
  color: #fff;
  margin-bottom: 4rpx;
}

.trophy-name.hidden-name {
  color: rgba(255, 255, 255, 0.4);
}

.trophy-condition {
  display: block;
  font-size: 18rpx;
  color: rgba(255, 255, 255, 0.5);
}

/* 稀有度颜色 */
.trophy-item.rarity-common.unlocked { border-color: rgba(200, 200, 200, 0.4); }
.trophy-item.rarity-uncommon.unlocked { border-color: rgba(76, 175, 80, 0.5); }
.trophy-item.rarity-rare.unlocked { border-color: rgba(33, 150, 243, 0.5); }
.trophy-item.rarity-epic.unlocked { border-color: rgba(156, 39, 176, 0.5); }
.trophy-item.rarity-legendary.unlocked { border-color: rgba(255, 152, 0, 0.5); }

/* 统计信息 */
.achievement-stats {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: var(--spacing-lg);
  padding: var(--spacing-sm) 0;
  background: rgba(0, 0, 0, 0.2);
}

.achievement-stats .stat-item {
  text-align: center;
}

.achievement-stats .stat-num {
  display: block;
  font-family: var(--font-number);
  font-size: 36rpx;
  font-weight: 700;
  color: #FFD700;
}

.achievement-stats .stat-label {
  display: block;
  font-size: 20rpx;
  color: rgba(255, 255, 255, 0.6);
}

.achievement-stats .stat-divider {
  width: 2rpx;
  height: 40rpx;
  background: rgba(255, 255, 255, 0.2);
}

/* 成就面板底部 */
.achievement-footer {
  padding: var(--spacing-sm) var(--spacing-md);
  padding-bottom: calc(var(--spacing-sm) + env(safe-area-inset-bottom, 16rpx));
}

.close-achievement-btn {
  width: 100%;
  text-align: center;
  padding: var(--spacing-sm) 0;
  background: linear-gradient(135deg, #4ECDC4 0%, #44A08D 100%);
  border-radius: var(--spacing-sm);
  color: #fff;
  font-family: var(--font-title);
  font-size: var(--font-size-body);
  font-weight: 600;
}

/* ========== 成就解锁全屏动画 ========== */
.achievement-unlock-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.85);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

.achievement-unlock-overlay.show {
  opacity: 1;
  pointer-events: auto;
}

.unlock-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
}

/* 光芒放射 */
.unlock-rays {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 400rpx;
  height: 400rpx;
}

.ray {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 4rpx;
  height: 200rpx;
  background: linear-gradient(180deg, rgba(255, 215, 0, 0.8) 0%, transparent 100%);
  transform-origin: bottom center;
  animation: ray-spin 3s linear infinite;
}

.ray.r1 { transform: translate(-50%, -100%) rotate(0deg); animation-delay: 0s; }
.ray.r2 { transform: translate(-50%, -100%) rotate(60deg); animation-delay: 0.5s; }
.ray.r3 { transform: translate(-50%, -100%) rotate(120deg); animation-delay: 1s; }
.ray.r4 { transform: translate(-50%, -100%) rotate(180deg); animation-delay: 1.5s; }
.ray.r5 { transform: translate(-50%, -100%) rotate(240deg); animation-delay: 2s; }
.ray.r6 { transform: translate(-50%, -100%) rotate(300deg); animation-delay: 2.5s; }

@keyframes ray-spin {
  0% { opacity: 0.3; }
  50% { opacity: 1; }
  100% { opacity: 0.3; }
}

/* 解锁奖杯 */
.unlock-trophy-wrap {
  width: 160rpx;
  height: 160rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  background: radial-gradient(circle, rgba(255, 215, 0, 0.3) 0%, transparent 70%);
  border-radius: 50%;
  margin-bottom: var(--spacing-md);
  animation: trophy-bounce 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
  z-index: 2;
}

.unlock-trophy-icon {
  font-size: 100rpx;
  filter: drop-shadow(0 0 30rpx rgba(255, 215, 0, 0.8));
}

@keyframes trophy-bounce {
  0% { transform: scale(0) rotate(-20deg); }
  60% { transform: scale(1.2) rotate(10deg); }
  100% { transform: scale(1) rotate(0deg); }
}

.unlock-label {
  display: block;
  font-family: var(--font-title);
  font-size: 28rpx;
  color: rgba(255, 255, 255, 0.8);
  margin-bottom: var(--spacing-xs);
  z-index: 2;
}

.unlock-name {
  display: block;
  font-family: var(--font-title);
  font-size: 40rpx;
  font-weight: 700;
  color: #FFD700;
  text-shadow: 0 0 20rpx rgba(255, 215, 0, 0.5);
  z-index: 2;
}

/* 闪烁星星 */
.unlock-sparkles {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
}

.sparkle {
  position: absolute;
  font-size: 32rpx;
  animation: sparkle-float 1.5s ease-in-out infinite;
}

.sparkle.s1 { top: 20%; left: 20%; animation-delay: 0s; }
.sparkle.s2 { top: 15%; right: 25%; animation-delay: 0.4s; }
.sparkle.s3 { bottom: 30%; left: 15%; animation-delay: 0.8s; }
.sparkle.s4 { bottom: 25%; right: 20%; animation-delay: 1.2s; }

@keyframes sparkle-float {
  0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.5; }
  50% { transform: scale(1.3) rotate(180deg); opacity: 1; }
}

/* ========== 分享卡片面板 ========== */
.share-card-mask {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  z-index: 900;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

.share-card-mask.show {
  opacity: 1;
  pointer-events: auto;
}

.share-card-panel {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.8);
  z-index: 950;
  opacity: 0;
  pointer-events: none;
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.share-card-panel.show {
  opacity: 1;
  pointer-events: auto;
  transform: translate(-50%, -50%) scale(1);
}

/* 卡片预览 */
.share-card-preview {
  width: 560rpx;
  background: #fff;
  border-radius: var(--spacing-md);
  overflow: hidden;
  box-shadow: 0 20rpx 80rpx rgba(0, 0, 0, 0.4);
  position: relative;
}

.card-bg-gradient {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 300rpx;
  background: linear-gradient(135deg, #4ECDC4 0%, #44A08D 50%, #667eea 100%);
}

/* 顶部装饰 */
.card-top-decor {
  position: relative;
  z-index: 2;
  padding: var(--spacing-lg) var(--spacing-md) var(--spacing-sm);
  text-align: center;
}

.card-app-name {
  display: block;
  font-family: var(--font-title);
  font-size: 32rpx;
  font-weight: 700;
  color: #fff;
  text-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.2);
}

.card-slogan {
  display: block;
  font-size: 20rpx;
  color: rgba(255, 255, 255, 0.8);
  margin-top: 4rpx;
}

/* 主角区域 */
.card-hero-section {
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: var(--spacing-md);
}

.card-bag-wrap {
  width: 120rpx;
  height: 120rpx;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: var(--spacing-sm);
}

.card-expression {
  font-size: 64rpx;
}

.card-title-wrap {
  background: linear-gradient(135deg, #FF6B6B 0%, #FF9A76 100%);
  padding: var(--spacing-xs) var(--spacing-md);
  border-radius: 30rpx;
}

.card-user-title {
  font-family: var(--font-title);
  font-size: 28rpx;
  font-weight: 700;
  color: #fff;
}

/* 数据区域 */
.card-data-section {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: var(--spacing-lg) var(--spacing-md);
  background: #fff;
}

.data-item {
  flex: 1;
  text-align: center;
}

.data-item.main .data-value {
  color: var(--color-danger);
  font-size: 40rpx;
}

.data-value {
  display: block;
  font-family: var(--font-number);
  font-size: 32rpx;
  font-weight: 700;
  color: var(--color-text);
}

.data-label {
  display: block;
  font-size: 20rpx;
  color: rgba(45, 52, 54, 0.5);
  margin-top: 4rpx;
}

.data-divider {
  width: 2rpx;
  height: 50rpx;
  background: rgba(45, 52, 54, 0.1);
  margin: 0 var(--spacing-sm);
}

/* 趣味标签 */
.card-tags {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: var(--spacing-xs);
  padding: 0 var(--spacing-md) var(--spacing-md);
  background: #fff;
}

.fun-tag {
  font-size: 20rpx;
  color: var(--color-primary);
  background: rgba(78, 205, 196, 0.1);
  padding: 4rpx var(--spacing-sm);
  border-radius: 20rpx;
}

/* 底部二维码区 */
.card-footer-section {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-md);
  background: linear-gradient(180deg, #fff 0%, #f8f9fa 100%);
  border-top: 2rpx dashed rgba(45, 52, 54, 0.1);
}

.card-date {
  font-size: 20rpx;
  color: rgba(45, 52, 54, 0.5);
  font-family: var(--font-title);
}

.qr-placeholder {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4rpx;
}

.qr-icon {
  font-size: 48rpx;
  opacity: 0.6;
}

.qr-hint {
  font-size: 18rpx;
  color: rgba(45, 52, 54, 0.5);
}

/* 操作按钮 */
.share-actions {
  display: flex;
  gap: var(--spacing-md);
  margin-top: var(--spacing-lg);
}

.share-btn {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: var(--spacing-sm) var(--spacing-md);
  background: rgba(255, 255, 255, 0.15);
  border-radius: var(--spacing-sm);
  border: 2rpx solid rgba(255, 255, 255, 0.3);
  backdrop-filter: blur(10rpx);
  transition: all 0.2s ease;
}

.share-btn:active {
  transform: scale(0.95);
  background: rgba(255, 255, 255, 0.25);
}

.share-btn-icon {
  font-size: 36rpx;
  margin-bottom: 4rpx;
}

.share-btn-text {
  font-size: 24rpx;
  color: #fff;
  font-family: var(--font-title);
}

/* 关闭按钮 */
.share-close {
  position: absolute;
  top: -60rpx;
  right: 0;
  width: 56rpx;
  height: 56rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  border: 2rpx solid rgba(255, 255, 255, 0.3);
  color: #fff;
  font-size: 28rpx;
}

/* ========== 空闲嘲讽气泡样式 ========== */
.taunt-message-popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.8);
  opacity: 0;
  pointer-events: none;
  transition: all 0.3s cubic-bezier(0.23, 1, 0.320, 1);
  z-index: 999;
}

.taunt-message-popup.show {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}

.taunt-bubble {
  background: linear-gradient(135deg, #FF6B9D 0%, #FFA06E 100%);
  border-radius: 40rpx;
  padding: 20rpx 40rpx;
  box-shadow: 0 8rpx 24rpx rgba(255, 107, 157, 0.3);
  border: 2rpx solid rgba(255, 255, 255, 0.5);
  position: relative;
  animation: taughtBounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.taunt-bubble::after {
  content: '';
  position: absolute;
  bottom: -12rpx;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 12rpx solid transparent;
  border-right: 12rpx solid transparent;
  border-top: 12rpx solid #FF6B9D;
}

.taunt-text {
  color: #fff;
  font-size: var(--font-size-title);
  font-weight: bold;
  font-family: var(--font-title);
  text-shadow: 2rpx 2rpx 4rpx rgba(0, 0, 0, 0.2);
}

@keyframes taughtBounce {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.3) rotateZ(-15deg);
  }
  60% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1.1) rotateZ(5deg);
  }
  100% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1) rotateZ(0deg);
  }
}

/* ========== 连击倍增指示器 ========== */
.combo-boost-indicator {
  position: absolute;
  top: -10rpx;
  right: -15rpx;
  background: linear-gradient(135deg, #FF4500 0%, #FFD700 100%);
  color: #fff;
  font-size: 20rpx;
  font-weight: bold;
  padding: 4rpx 12rpx;
  border-radius: 20rpx;
  border: 2rpx solid rgba(255, 255, 255, 0.6);
  box-shadow: 0 4rpx 12rpx rgba(255, 69, 0, 0.3);
  animation: boostPulse 0.6s ease-in-out infinite;
}

@keyframes boostPulse {
  0%, 100% {
    transform: scale(1);
    box-shadow: 0 4rpx 12rpx rgba(255, 69, 0, 0.3);
  }
  50% {
    transform: scale(1.15);
    box-shadow: 0 8rpx 20rpx rgba(255, 69, 0, 0.5);
  }
}

/* ========== 包库面板 ========== */
.bag-library-mask {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.6);
  z-index: 910;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

.bag-library-mask.show {
  opacity: 1;
  pointer-events: auto;
}

.bag-library-panel {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 80vh;
  background: #1A1A1A;
  backdrop-filter: blur(30rpx);
  -webkit-backdrop-filter: blur(30rpx);
  border-radius: 40rpx 40rpx 0 0;
  z-index: 920;
  display: flex;
  flex-direction: column;
  transform: translateY(100%);
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  pointer-events: auto;
  box-shadow:
    inset 0 1rpx 0 rgba(255, 255, 255, 0.05),
    0 -8rpx 32rpx rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.bag-library-panel.show {
  transform: translateY(0);
}

/* 包库头部 */
.bag-lib-header {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: var(--spacing-md) var(--spacing-md) var(--spacing-sm);
  background: linear-gradient(180deg, #2D2D2D 0%, #1A1A1A 100%);
  position: relative;
}

.bag-lib-drag-indicator {
  width: 60rpx;
  height: 6rpx;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 3rpx;
  margin-bottom: var(--spacing-sm);
}

.bag-lib-title {
  font-family: var(--font-title);
  font-size: 40rpx;
  font-weight: 700;
  color: #FFFFFF;
  margin-bottom: 4rpx;
}

.bag-lib-subtitle {
  font-family: var(--font-title);
  font-size: var(--font-size-small);
  color: #B8B8B8;
}

.bag-lib-close {
  position: absolute;
  top: var(--spacing-md);
  right: var(--spacing-md);
  width: 44rpx;
  height: 44rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 50%;
  border: 1rpx solid rgba(255, 255, 255, 0.15);
  color: #fff;
  font-size: 24rpx;
}

/* 包库网格 */
.bag-lib-scroll {
  flex: 1;
  padding: var(--spacing-md) 0;
}

.bag-lib-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--spacing-md);
  padding: var(--spacing-md) var(--spacing-md);
  padding-bottom: var(--spacing-lg);
}

/* 包库项 */
.bag-lib-item {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-sm);
  background: linear-gradient(145deg, #282828 0%, #1E1E1E 100%);
  border-radius: 20rpx;
  border: 2rpx solid rgba(255, 165, 0, 0.15);
  overflow: hidden;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  cursor: pointer;
}

.bag-lib-item.selected {
  border: 3rpx solid #FFA500;
  box-shadow:
    0 0 15rpx rgba(255, 165, 0, 0.5),
    0 0 30rpx rgba(255, 165, 0, 0.2),
    0 8rpx 24rpx rgba(0, 0, 0, 0.4);
  transform: translateY(-4rpx);
}

.bag-lib-item:active {
  transform: scale(0.96);
}

/* 包预览容器 */
.bag-preview-container {
  position: relative;
  width: 100%;
  height: 200rpx;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 16rpx;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
}

.bag-preview-canvas {
  width: 100%;
  height: 100%;
  display: block;
}

/* 选中勾选标记 */
.bag-selected-badge {
  position: absolute;
  top: 8rpx;
  right: 8rpx;
  width: 36rpx;
  height: 36rpx;
  background: linear-gradient(135deg, #4ECDC4 0%, #44A08D 100%);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4rpx 12rpx rgba(78, 205, 196, 0.5);
}

.badge-icon {
  font-size: 20rpx;
  color: #fff;
  font-weight: bold;
}

/* 包库信息 */
.bag-lib-info {
  width: 100%;
  text-align: center;
}

.bag-lib-name {
  display: block;
  font-family: var(--font-title);
  font-size: 22rpx;
  font-weight: 600;
  color: #fff;
  margin-bottom: 4rpx;
}

.bag-lib-rarity {
  display: block;
  font-size: 16rpx;
  font-weight: 600;
  margin-bottom: 4rpx;
}

.bag-lib-rarity.rarity-common { color: #9E9E9E; }
.bag-lib-rarity.rarity-uncommon { color: #4CAF50; }
.bag-lib-rarity.rarity-rare { color: #2196F3; }
.bag-lib-rarity.rarity-epic { color: #9C27B0; }
.bag-lib-rarity.rarity-legendary { color: #FFD700; }

.bag-lib-desc {
  display: block;
  font-size: 16rpx;
  color: rgba(255, 255, 255, 0.5);
  line-height: 1.3;
}

/* 稀有度标签 */
.bag-rarity-label {
  position: absolute;
  top: var(--spacing-xs);
  left: var(--spacing-xs);
  padding: 4rpx 12rpx;
  border-radius: 12rpx;
  font-size: 14rpx;
  font-weight: 600;
  color: #fff;
  background-color: rgba(255, 165, 0, 0.2);
  border: 1rpx solid rgba(255, 165, 0, 0.3);
}

.bag-rarity-label.rarity-common {
  background-color: rgba(158, 158, 158, 0.2);
  border-color: rgba(158, 158, 158, 0.3);
  color: #CCCCCC;
}

.bag-rarity-label.rarity-uncommon {
  background-color: rgba(76, 175, 80, 0.2);
  border-color: rgba(76, 175, 80, 0.3);
  color: #A5D6A7;
}

.bag-rarity-label.rarity-rare {
  background-color: rgba(33, 150, 243, 0.2);
  border-color: rgba(33, 150, 243, 0.3);
  color: #81D4FA;
}

.bag-rarity-label.rarity-epic {
  background-color: rgba(156, 39, 176, 0.2);
  border-color: rgba(156, 39, 176, 0.3);
  color: #CE93D8;
}

.bag-rarity-label.rarity-legendary {
  background-color: rgba(255, 215, 0, 0.2);
  border-color: rgba(255, 215, 0, 0.4);
  color: #FFD700;
  box-shadow: 0 0 8rpx rgba(255, 215, 0, 0.3);
}


