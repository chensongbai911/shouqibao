# å˜æ›´ææ¡ˆï¼šæ¸¸æˆå¢å¼ºåŠŸèƒ½å¥—ä»¶

**ææ¡ˆç¼–å·ï¼š** CHANGE-2025-12-05-001
**ææ¡ˆæ—¥æœŸï¼š** 2025å¹´12æœˆ5æ—¥
**ææ¡ˆçŠ¶æ€ï¼š** ğŸŸ¡ å¾…å®¡æ ¸ (Pending Review)
**å½±å“èŒƒå›´ï¼š** ä¸­ç­‰ - æ–°å¢å¤šä¸ªåŠŸèƒ½æ¨¡å—
**é¢„è®¡å·¥ä½œé‡ï¼š** 10-15 ä¸ªå·¥ä½œæ—¥

---

## ğŸ“‹ æ¦‚è¿° (Overview)

æœ¬ææ¡ˆæ—¨åœ¨ä¸º"å—æ°”åŒ…è§£å‹å°ç¨‹åº"æ·»åŠ å…­å¤§æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼Œä»¥æå‡ç”¨æˆ·ç•™å­˜ç‡ã€å¨±ä¹æ€§å’Œå˜ç°èƒ½åŠ›ï¼š

1. **æ–°æ­¦å™¨ç±»å‹ç³»ç»Ÿ** - æ‰©å±•æ­¦å™¨åº“ï¼Œå¢åŠ ç¨€æœ‰åº¦å’Œè§£é”æœºåˆ¶
2. **æˆå°±ç³»ç»Ÿ** - æä¾›é•¿æœŸç›®æ ‡å’Œå³æ—¶åé¦ˆ
3. **å¥½å‹å¯¹æˆ˜** - å¢åŠ ç¤¾äº¤ç«æŠ€å…ƒç´ 
4. **æ¯æ—¥ä»»åŠ¡** - æå‡æ—¥æ´»å’Œç”¨æˆ·ç²˜æ€§
5. **éŸ³æ•ˆè‡ªå®šä¹‰** - å…è®¸ç”¨æˆ·ä¸Šä¼ /é€‰æ‹©ä¸ªæ€§åŒ–éŸ³æ•ˆ
6. **çš®è‚¤å•†åŸ** - å¼•å…¥è™šæ‹Ÿå•†å“ç»æµç³»ç»Ÿ

---

## ğŸ¯ åŠ¨æœº (Motivation)

### å½“å‰ç—›ç‚¹
- **ç•™å­˜ä¸è¶³**ï¼šç”¨æˆ·æ‰“å‡»å‡ æ¬¡åç¼ºä¹æ–°é²œæ„Ÿ
- **å•è°ƒä½“éªŒ**ï¼šæ­¦å™¨å’Œè§†è§‰åé¦ˆæœ‰é™
- **ç¤¾äº¤ç¼ºå¤±**ï¼šæ²¡æœ‰ä¸å¥½å‹äº’åŠ¨çš„æœºåˆ¶
- **å˜ç°å›°éš¾**ï¼šç¼ºä¹å¯æŒç»­çš„æ”¶å…¥æ¨¡å¼

### é¢„æœŸæ”¶ç›Š
- âœ… **æå‡ 7 æ—¥ç•™å­˜ç‡** ä» 20% â†’ 40%
- âœ… **å¢åŠ æ—¥å‡ä½¿ç”¨æ—¶é•¿** ä» 2 åˆ†é’Ÿ â†’ 5 åˆ†é’Ÿ
- âœ… **æé«˜åˆ†äº«ç‡** é€šè¿‡å¥½å‹å¯¹æˆ˜åŠŸèƒ½
- âœ… **å»ºç«‹å˜ç°æ¸ é“** é€šè¿‡çš®è‚¤å•†åŸ

---

## ğŸ“¦ åŠŸèƒ½ 1: æ–°æ­¦å™¨ç±»å‹ç³»ç»Ÿ

### è®¾è®¡ç›®æ ‡
æ‰©å±•ç°æœ‰çš„ 3 ç§æ­¦å™¨ï¼ˆæ‹³å¤´/æ‹–é‹/å¹³åº•é”…ï¼‰è‡³ **15+ ç§æ­¦å™¨**ï¼Œå¼•å…¥ç¨€æœ‰åº¦å’Œè§£é”æœºåˆ¶ã€‚

### æ–°å¢æ­¦å™¨åˆ†ç±»

| ç¨€æœ‰åº¦ | æ­¦å™¨åç§° | ä¼¤å®³å€ç‡ | ç‰¹æ•ˆ | è§£é”æ¡ä»¶ |
|--------|----------|----------|------|----------|
| âšª æ™®é€š | æ‹³å¤´ | 1x | æ™®é€šéŸ³æ•ˆ | åˆå§‹æ‹¥æœ‰ |
| âšª æ™®é€š | æ‹–é‹ | 1x | å•ªå—’å£° | åˆå§‹æ‹¥æœ‰ |
| âšª æ™®é€š | å¹³åº•é”… | 1.2x | é“›é“›å£° | åˆå§‹æ‹¥æœ‰ |
| ğŸŸ¢ ç¨€æœ‰ | æ¦´è² | 1.5x | è‡­æ°”ç‰¹æ•ˆ | ç´¯è®¡ 1000 æ¬¡ç‚¹å‡» |
| ğŸŸ¢ ç¨€æœ‰ | é”®ç›˜ | 1.5x | ç¨‹åºå‘˜æ¢— | åˆ†äº« 3 æ¬¡ |
| ğŸ”µ å²è¯— | é›·ç¥ä¹‹é”¤ | 2x | é—ªç”µç‰¹æ•ˆ | è¾¾æˆ"è¿å‡»ç‹"æˆå°± |
| ğŸ”µ å²è¯— | é¾™è™¾ | 2x | é’³å­åŠ¨ç”» | å•†åŸè´­ä¹° (9.9å…ƒ) |
| ğŸŸ£ ä¼ è¯´ | æ— é™æ‰‹å¥— | 3x | ç°é£çƒŸç­ | æ’è¡Œæ¦œå‰ 10 |
| ğŸŸ¡ ç¥è¯ | æ©¡çš®æ“¦ | 5x | æ“¦é™¤æ•ˆæœ | é™æ—¶æ´»åŠ¨è·å¾— |

### æŠ€æœ¯å®ç°

#### æ•°æ®ç»“æ„
```javascript
// store/weapons.js
export const weaponList = [
  {
    id: 'fist',
    name: 'æ‹³å¤´',
    rarity: 'common',
    damageMultiplier: 1,
    icon: '/static/weapons/fist.png',
    audioSrc: '/static/audio/punch.mp3',
    unlocked: true,
    effectType: 'normal'
  },
  {
    id: 'durian',
    name: 'æ¦´è²',
    rarity: 'rare',
    damageMultiplier: 1.5,
    icon: '/static/weapons/durian.png',
    audioSrc: '/static/audio/durian.mp3',
    unlocked: false,
    unlockCondition: { type: 'clicks', value: 1000 },
    effectType: 'stink' // è‡­æ°”ç²’å­ç‰¹æ•ˆ
  }
  // ...æ›´å¤šæ­¦å™¨
];
```

#### ç»„ä»¶å˜æ›´
**æ–‡ä»¶ï¼š** `components/WeaponPanel.vue`
```vue
<template>
  <view class="weapon-panel">
    <!-- æ–°å¢ï¼šç¨€æœ‰åº¦ç­›é€‰ -->
    <view class="rarity-filter">
      <button
        v-for="rarity in rarities"
        :key="rarity"
        @click="filterByRarity(rarity)"
      >
        {{ rarity }}
      </button>
    </view>

    <!-- æ­¦å™¨ç½‘æ ¼ -->
    <view class="weapon-grid">
      <view
        v-for="weapon in filteredWeapons"
        :key="weapon.id"
        :class="['weapon-item', weapon.rarity, { locked: !weapon.unlocked }]"
        @click="selectWeapon(weapon)"
      >
        <image :src="weapon.icon" />
        <text>{{ weapon.name }}</text>

        <!-- æœªè§£é”æç¤º -->
        <view v-if="!weapon.unlocked" class="lock-overlay">
          ğŸ”’ {{ weapon.unlockCondition.desc }}
        </view>
      </view>
    </view>
  </view>
</template>

<script setup>
import { ref, computed } from 'vue';
import { useWeaponStore } from '@/store/weapons';

const weaponStore = useWeaponStore();
const selectedRarity = ref('all');

const filteredWeapons = computed(() => {
  if (selectedRarity.value === 'all') return weaponStore.weapons;
  return weaponStore.weapons.filter(w => w.rarity === selectedRarity.value);
});
</script>
```

#### äº‘æ•°æ®åº“ç»“æ„
```javascript
// é›†åˆï¼šuser_weapons
{
  _id: "xxx",
  _openid: "user123",
  unlockedWeapons: ['fist', 'slipper', 'pan', 'durian'],
  equippedWeapon: 'durian',
  updateTime: Date
}
```

---

## ğŸ† åŠŸèƒ½ 2: æˆå°±ç³»ç»Ÿ

### è®¾è®¡ç›®æ ‡
æä¾› **30+ æˆå°±**ï¼Œè¦†ç›–ä¸åŒç©æ³•ç»´åº¦ï¼Œå¢å¼ºæ¸¸æˆæ·±åº¦ã€‚

### æˆå°±åˆ†ç±»

#### A. åŸºç¡€æˆå°±ï¼ˆæ–°æ‰‹å¼•å¯¼ï¼‰
| æˆå°±åç§° | æ¡ä»¶ | å¥–åŠ± |
|----------|------|------|
| åˆå‡ºèŒ…åº | å®Œæˆç¬¬ 1 æ¬¡ç‚¹å‡» | è§£é”"æ–°æ‰‹å…‰ç¯"ç§°å· |
| ç™¾å‘ç™¾ä¸­ | ç´¯è®¡ç‚¹å‡» 100 æ¬¡ | è·å¾— 100 é‡‘å¸ |
| åƒé”¤ç™¾ç‚¼ | ç´¯è®¡ç‚¹å‡» 1000 æ¬¡ | è§£é”"æ¦´è²"æ­¦å™¨ |

#### B. æŠ€å·§æˆå°±ï¼ˆé«˜éš¾åº¦ï¼‰
| æˆå°±åç§° | æ¡ä»¶ | å¥–åŠ± |
|----------|------|------|
| è¿å‡»ç‹ | å•æ¬¡è¿å‡» 50 combo | è§£é”"é›·ç¥ä¹‹é”¤" |
| å…‰é€Ÿæ‰‹ | 1 ç§’å†…ç‚¹å‡» 10 æ¬¡ | è·å¾—"é—ªç”µ"ç‰¹æ•ˆ |
| é©¬æ‹‰æ¾æˆ˜å£« | è¿ç»­æ‰“å‡» 10 åˆ†é’Ÿä¸åœ | è§£é”"ä¸å±ˆ"çš®è‚¤ |

#### C. ç¤¾äº¤æˆå°±
| æˆå°±åç§° | æ¡ä»¶ | å¥–åŠ± |
|----------|------|------|
| ç¤¾äº¤è¾¾äºº | åˆ†äº«ç»™ 10 ä½å¥½å‹ | è·å¾—ç¨€æœ‰çš®è‚¤æŠ½å¥–åˆ¸ |
| æ“‚å°å† å†› | å¥½å‹å¯¹æˆ˜è·èƒœ 5 æ¬¡ | è§£é”"ç‹è€…"è¾¹æ¡† |

#### D. æ”¶é›†æˆå°±
| æˆå°±åç§° | æ¡ä»¶ | å¥–åŠ± |
|----------|------|------|
| æ­¦å™¨å¤§å¸ˆ | æ”¶é›†å…¨éƒ¨æ™®é€šæ­¦å™¨ | è·å¾— 500 é‡‘å¸ |
| çš®è‚¤ç‹‚çƒ­è€… | æ‹¥æœ‰ 10 æ¬¾çš®è‚¤ | è§£é”éšè—çš®è‚¤ |

### æŠ€æœ¯å®ç°

#### æˆå°±æ•°æ®ç»“æ„
```javascript
// store/achievements.js
export const achievementList = [
  {
    id: 'first_blood',
    name: 'åˆå‡ºèŒ…åº',
    desc: 'å®Œæˆç¬¬1æ¬¡ç‚¹å‡»',
    icon: '/static/achievements/first.png',
    type: 'basic',
    condition: {
      stat: 'totalClicks',
      operator: '>=',
      value: 1
    },
    reward: {
      type: 'title',
      value: 'newbie_halo'
    },
    unlocked: false,
    unlockedAt: null
  }
  // ...æ›´å¤šæˆå°±
];
```

#### æˆå°±æ£€æµ‹é€»è¾‘
```javascript
// utils/achievementChecker.js
export function checkAchievements(userStats) {
  const newUnlocks = [];

  achievementList.forEach(achievement => {
    if (achievement.unlocked) return;

    const { stat, operator, value } = achievement.condition;
    const currentValue = userStats[stat];

    let unlocked = false;
    switch (operator) {
      case '>=': unlocked = currentValue >= value; break;
      case '==': unlocked = currentValue === value; break;
      // ...æ›´å¤šæ¡ä»¶
    }

    if (unlocked) {
      achievement.unlocked = true;
      achievement.unlockedAt = new Date();
      newUnlocks.push(achievement);

      // å‘æ”¾å¥–åŠ±
      grantReward(achievement.reward);
    }
  });

  return newUnlocks; // è¿”å›æ–°è§£é”çš„æˆå°±ç”¨äºå¼¹çª—å±•ç¤º
}
```

#### UI ç»„ä»¶
**æ–°å¢æ–‡ä»¶ï¼š** `pages/achievements/index.vue`
```vue
<template>
  <view class="achievement-page">
    <view class="progress-bar">
      å·²è§£é”: {{ unlockedCount }} / {{ totalCount }}
    </view>

    <view class="achievement-list">
      <view
        v-for="ach in achievements"
        :key="ach.id"
        :class="['ach-card', { unlocked: ach.unlocked }]"
      >
        <image :src="ach.icon" :class="{ grayscale: !ach.unlocked }" />
        <view class="info">
          <text class="name">{{ ach.name }}</text>
          <text class="desc">{{ ach.desc }}</text>
        </view>
        <view v-if="ach.unlocked" class="badge">âœ“</view>
      </view>
    </view>
  </view>
</template>
```

---

## âš”ï¸ åŠŸèƒ½ 3: å¥½å‹å¯¹æˆ˜

### è®¾è®¡ç›®æ ‡
å¼•å…¥ **å¼‚æ­¥ PVP æœºåˆ¶**ï¼Œå…è®¸ç©å®¶æŒ‘æˆ˜å¥½å‹çš„æœ€é«˜åˆ†ï¼Œå¢å¼ºç¤¾äº¤ä¼ æ’­ã€‚

### å¯¹æˆ˜æ¨¡å¼

#### æ¨¡å¼ Aï¼šåˆ†æ•°æŒ‘æˆ˜èµ›
- ç©å®¶ A æŒ‘æˆ˜ç©å®¶ B çš„"ä»Šæ—¥æœ€é«˜åˆ†"
- é™æ—¶ 60 ç§’ï¼Œçœ‹è°æ‰“å‡ºæ›´é«˜ä¼¤å®³
- èƒœè€…è·å¾—å¥–åŠ±ï¼ˆé‡‘å¸/ç§°å·ï¼‰

#### æ¨¡å¼ Bï¼šè¿å‡»ç«é€Ÿ
- æ¯”æ‹¼è°å…ˆè¾¾åˆ° 100 combo
- è®°å½•æœ€å¿«æ—¶é—´

### äº¤äº’æµç¨‹
```
1. ç©å®¶ç‚¹å‡»"å¥½å‹å¯¹æˆ˜"æŒ‰é’®
2. é€‰æ‹©å¥½å‹ï¼ˆä»å¾®ä¿¡å¥½å‹åˆ—è¡¨æˆ–å°ç¨‹åºå†…å¥½å‹ï¼‰
3. å‘é€æŒ‘æˆ˜ï¼ˆå¾®ä¿¡å¡ç‰‡åˆ†äº«ï¼‰
4. å¥½å‹ç‚¹å‡»å¡ç‰‡è¿›å…¥å¯¹æˆ˜æ¨¡å¼
5. å¯¹æˆ˜ç»“æŸåç”Ÿæˆæˆ˜æŠ¥åˆ†äº«
```

### æŠ€æœ¯å®ç°

#### å¯¹æˆ˜æ•°æ®ç»“æ„
```javascript
// äº‘æ•°æ®åº“é›†åˆï¼šbattle_records
{
  _id: "battle_xxx",
  challenger: {
    openid: "user_a",
    nickname: "å¼ ä¸‰",
    avatar: "https://xxx.jpg",
    score: 9999
  },
  defender: {
    openid: "user_b",
    nickname: "æå››",
    avatar: "https://yyy.jpg",
    score: 8888
  },
  battleMode: "score_challenge",
  winner: "user_a",
  battleTime: Date,
  status: "completed" // pending | completed
}
```

#### æŒ‘æˆ˜å‘èµ·é€»è¾‘
```javascript
// pages/battle/challenge.js
async function sendChallenge(friendOpenId) {
  // 1. åˆ›å»ºå¯¹æˆ˜è®°å½•
  const battleRecord = await wx.cloud.callFunction({
    name: 'createBattle',
    data: {
      defenderOpenId: friendOpenId,
      mode: 'score_challenge'
    }
  });

  // 2. åˆ†äº«å¾®ä¿¡å¡ç‰‡
  wx.shareAppMessage({
    title: `æˆ‘å‘ä½ å‘èµ·äº†å—æ°”åŒ…å¯¹æˆ˜æŒ‘æˆ˜ï¼`,
    path: `/pages/battle/arena?battleId=${battleRecord.battleId}`,
    imageUrl: '/static/share/battle.png'
  });
}
```

#### å¯¹æˆ˜é¡µé¢
**æ–°å¢æ–‡ä»¶ï¼š** `pages/battle/arena.vue`
```vue
<template>
  <view class="battle-arena">
    <!-- å€’è®¡æ—¶ -->
    <view class="timer">{{ countdown }}s</view>

    <!-- å¯¹æˆ˜åŒæ–¹ä¿¡æ¯ -->
    <view class="vs-panel">
      <view class="player">
        <image :src="challenger.avatar" />
        <text>{{ challenger.nickname }}</text>
        <text class="score">{{ challenger.score }}</text>
      </view>

      <text class="vs">VS</text>

      <view class="player">
        <image :src="defender.avatar" />
        <text>{{ defender.nickname }}</text>
        <text class="score">{{ defender.score }}</text>
      </view>
    </view>

    <!-- å—æ°”åŒ…ï¼ˆå¤ç”¨ç°æœ‰ç»„ä»¶ï¼‰ -->
    <BagSprite @hit="onBattleHit" />

    <!-- æˆ˜æŠ¥ -->
    <view v-if="battleEnded" class="result-panel">
      <text class="winner">{{ winner.nickname }} è·èƒœï¼</text>
      <button @click="shareResult">åˆ†äº«æˆ˜æŠ¥</button>
    </view>
  </view>
</template>
```

---

## ğŸ“… åŠŸèƒ½ 4: æ¯æ—¥ä»»åŠ¡

### è®¾è®¡ç›®æ ‡
æä¾› **æ¯æ—¥ 3 ä¸ªä»»åŠ¡**ï¼Œå¼•å¯¼ç”¨æˆ·æ¯å¤©æ‰“å¼€å°ç¨‹åºï¼Œæå‡æ—¥æ´»ã€‚

### ä»»åŠ¡ç±»å‹

#### æ¯æ—¥ä»»åŠ¡æ± ï¼ˆæ¯å¤©éšæœº 3 ä¸ªï¼‰
| ä»»åŠ¡åç§° | ç›®æ ‡ | å¥–åŠ± |
|----------|------|------|
| æ—©èµ·è§£å‹ | 09:00 å‰å®Œæˆ 10 æ¬¡ç‚¹å‡» | 50 é‡‘å¸ |
| åˆé—´æ”¾æ¾ | ç‚¹å‡»å—æ°”åŒ… 50 æ¬¡ | 100 é‡‘å¸ |
| æ­¦å™¨è¯•ç‚¼ | ä½¿ç”¨ 3 ç§ä¸åŒæ­¦å™¨å„æ‰“ 10 æ¬¡ | ç¨€æœ‰æ­¦å™¨æŠ½å¥–åˆ¸ |
| è¿å‡»å¤§å¸ˆ | è¾¾æˆ 30 combo | ç‰¹æ•ˆçš®è‚¤ç¢ç‰‡ x1 |
| ç¤¾äº¤ä»»åŠ¡ | åˆ†äº« 1 æ¬¡ | 200 é‡‘å¸ |

#### å‘¨å¸¸ä»»åŠ¡
| ä»»åŠ¡åç§° | ç›®æ ‡ | å¥–åŠ± |
|----------|------|------|
| æœ¬å‘¨ä¹‹æ˜Ÿ | ç´¯è®¡ç‚¹å‡» 500 æ¬¡ | å²è¯—æ­¦å™¨å®ç®± |
| å¯¹æˆ˜ç‹è€… | å¥½å‹å¯¹æˆ˜è·èƒœ 3 æ¬¡ | ä¼ è¯´çš®è‚¤ç¢ç‰‡ x3 |

### æŠ€æœ¯å®ç°

#### ä»»åŠ¡æ•°æ®ç»“æ„
```javascript
// äº‘æ•°æ®åº“é›†åˆï¼šuser_daily_tasks
{
  _openid: "user123",
  date: "2025-12-05",
  tasks: [
    {
      id: "task_morning_clicks",
      name: "æ—©èµ·è§£å‹",
      desc: "09:00å‰å®Œæˆ10æ¬¡ç‚¹å‡»",
      progress: 7,
      target: 10,
      reward: { type: 'coin', value: 50 },
      completed: false,
      claimed: false
    }
    // ...å¦å¤–2ä¸ªä»»åŠ¡
  ],
  refreshTime: Date
}
```

#### ä»»åŠ¡åˆ·æ–°é€»è¾‘
```javascript
// cloudfunctions/refreshDailyTasks/index.js
exports.main = async (event, context) => {
  const { OPENID } = cloud.getWXContext();
  const today = new Date().toISOString().split('T')[0];

  // æ£€æŸ¥ä»Šå¤©æ˜¯å¦å·²åˆ·æ–°
  const existingTasks = await db.collection('user_daily_tasks')
    .where({ _openid: OPENID, date: today })
    .get();

  if (existingTasks.data.length > 0) {
    return { code: 0, data: existingTasks.data[0] };
  }

  // ä»ä»»åŠ¡æ± éšæœºæŠ½å–3ä¸ª
  const allTasks = [...dailyTaskPool];
  const selectedTasks = shuffleArray(allTasks).slice(0, 3);

  // åˆå§‹åŒ–ä»»åŠ¡è¿›åº¦
  const tasksData = selectedTasks.map(task => ({
    ...task,
    progress: 0,
    completed: false,
    claimed: false
  }));

  // å†™å…¥æ•°æ®åº“
  await db.collection('user_daily_tasks').add({
    data: {
      date: today,
      tasks: tasksData,
      refreshTime: new Date()
    }
  });

  return { code: 0, data: tasksData };
};
```

#### UI ç»„ä»¶
**æ–°å¢æ–‡ä»¶ï¼š** `components/DailyTaskPanel.vue`
```vue
<template>
  <view class="task-panel">
    <view class="header">
      <text>æ¯æ—¥ä»»åŠ¡</text>
      <text class="refresh-tip">æ˜æ—¥ 00:00 åˆ·æ–°</text>
    </view>

    <view v-for="task in tasks" :key="task.id" class="task-item">
      <view class="info">
        <text class="name">{{ task.name }}</text>
        <text class="desc">{{ task.desc }}</text>
      </view>

      <!-- è¿›åº¦æ¡ -->
      <view class="progress">
        <view
          class="bar"
          :style="{ width: (task.progress / task.target * 100) + '%' }"
        />
        <text>{{ task.progress }} / {{ task.target }}</text>
      </view>

      <!-- å¥–åŠ±æŒ‰é’® -->
      <button
        v-if="task.completed && !task.claimed"
        @click="claimReward(task)"
        class="claim-btn"
      >
        é¢†å– {{ task.reward.value }} ğŸ’°
      </button>
      <view v-else-if="task.claimed" class="claimed">âœ“ å·²é¢†å–</view>
    </view>
  </view>
</template>
```

---

## ğŸµ åŠŸèƒ½ 5: éŸ³æ•ˆè‡ªå®šä¹‰

### è®¾è®¡ç›®æ ‡
å…è®¸ç”¨æˆ·ä¸Šä¼ æˆ–ä»éŸ³æ•ˆåº“é€‰æ‹©ä¸ªæ€§åŒ–æ‰“å‡»éŸ³æ•ˆã€‚

### åŠŸèƒ½ç‰¹æ€§
1. **å†…ç½®éŸ³æ•ˆåº“**ï¼šæä¾› 20+ é¢„è®¾éŸ³æ•ˆï¼ˆåŠ¨ç‰©å«å£°ã€æ–¹è¨€éª‚äººã€æç¬‘æ¢—ï¼‰
2. **ç”¨æˆ·ä¸Šä¼ **ï¼šæ”¯æŒä¸Šä¼  MP3 æ–‡ä»¶ï¼ˆâ‰¤ 500KBï¼‰
3. **æ–‡å­—è½¬è¯­éŸ³ï¼ˆTTSï¼‰**ï¼šè¾“å…¥æ–‡å­—è‡ªåŠ¨ç”Ÿæˆè¯­éŸ³

### éŸ³æ•ˆåˆ†ç±»

| åˆ†ç±» | éŸ³æ•ˆç¤ºä¾‹ | è§£é”æ–¹å¼ |
|------|----------|----------|
| åŸºç¡€ | æ‹³å‡»å£°ã€å·´æŒå£° | å…è´¹ |
| æç¬‘ | "awsl"ã€"çœŸé¦™"ã€"å“å“Ÿå–‚" | è§‚çœ‹å¹¿å‘Šè§£é” |
| æ–¹è¨€ | ä¸œåŒ—è¯"å¹²å“ˆå‘¢"ã€ç²¤è¯­"æ‰‘è¡—" | é‡‘å¸è´­ä¹° |
| åŠ¨ç‰© | çŒªå«ã€é¸­å«ã€ç‹—å« | æˆå°±è§£é” |
| æ˜æ˜Ÿ | ï¼ˆéœ€æˆæƒï¼‰ç»å…¸å°è¯ | ä»˜è´¹è´­ä¹° |
| è‡ªå®šä¹‰ | ç”¨æˆ·ä¸Šä¼  | VIP åŠŸèƒ½ |

### æŠ€æœ¯å®ç°

#### éŸ³æ•ˆç®¡ç†å™¨
```javascript
// utils/AudioManager.js
class AudioManager {
  constructor() {
    this.audioPool = []; // éŸ³é¢‘å®ä¾‹æ± 
    this.currentSound = 'punch'; // å½“å‰é€‰ä¸­éŸ³æ•ˆ
    this.soundLibrary = new Map(); // éŸ³æ•ˆåº“
  }

  // åŠ è½½éŸ³æ•ˆåº“
  async loadSoundLibrary() {
    const sounds = await wx.cloud.database()
      .collection('sound_library')
      .get();

    sounds.data.forEach(sound => {
      this.soundLibrary.set(sound.id, sound.url);
    });
  }

  // åˆ‡æ¢éŸ³æ•ˆ
  switchSound(soundId) {
    this.currentSound = soundId;
    // æ¸…ç©ºæ—§çš„éŸ³é¢‘æ± 
    this.audioPool.forEach(audio => audio.destroy());
    this.audioPool = [];
    // é‡æ–°åˆ›å»ºéŸ³é¢‘æ± 
    this.initAudioPool(this.soundLibrary.get(soundId));
  }

  // ä¸Šä¼ è‡ªå®šä¹‰éŸ³æ•ˆ
  async uploadCustomSound(filePath) {
    // 1. å‹ç¼©æ£€æŸ¥
    const fileInfo = await wx.getFileInfo({ filePath });
    if (fileInfo.size > 500 * 1024) {
      throw new Error('æ–‡ä»¶è¶…è¿‡500KB');
    }

    // 2. ä¸Šä¼ åˆ°äº‘å­˜å‚¨
    const cloudPath = `custom-sounds/${Date.now()}-${Math.random()}.mp3`;
    const result = await wx.cloud.uploadFile({
      cloudPath,
      filePath
    });

    // 3. ä¿å­˜åˆ°æ•°æ®åº“
    await wx.cloud.database().collection('user_custom_sounds').add({
      data: {
        cloudPath,
        fileID: result.fileID,
        uploadTime: new Date()
      }
    });

    return result.fileID;
  }
}
```

#### TTS é›†æˆ
```javascript
// è°ƒç”¨å¾®ä¿¡äº‘å¼€å‘æˆ–ç¬¬ä¸‰æ–¹ TTS API
async function textToSpeech(text) {
  const result = await wx.cloud.callFunction({
    name: 'tts',
    data: {
      text: text,
      voice: 'zh-CN-XiaoxiaoNeural', // å¾®è½¯ TTS
      speed: 1.2
    }
  });

  return result.audioUrl;
}
```

#### UI ç•Œé¢
**æ–°å¢æ–‡ä»¶ï¼š** `pages/sound-custom/index.vue`
```vue
<template>
  <view class="sound-custom">
    <!-- éŸ³æ•ˆåº“ -->
    <view class="sound-library">
      <view
        v-for="sound in soundList"
        :key="sound.id"
        :class="['sound-item', { selected: currentSound === sound.id }]"
        @click="selectSound(sound)"
      >
        <text>{{ sound.name }}</text>
        <button @click.stop="previewSound(sound)">è¯•å¬</button>
      </view>
    </view>

    <!-- ä¸Šä¼ åŒºåŸŸ -->
    <view class="upload-area">
      <button @click="chooseAudio">ä¸Šä¼ éŸ³æ•ˆæ–‡ä»¶</button>
      <text class="tip">æ”¯æŒ MP3 æ ¼å¼ï¼Œâ‰¤ 500KB</text>
    </view>

    <!-- TTS ç”Ÿæˆ -->
    <view class="tts-area">
      <input
        v-model="ttsText"
        placeholder="è¾“å…¥æ–‡å­—ï¼Œç”Ÿæˆè¯­éŸ³"
        maxlength="20"
      />
      <button @click="generateTTS">ç”Ÿæˆ</button>
    </view>
  </view>
</template>

<script setup>
const chooseAudio = () => {
  wx.chooseMessageFile({
    count: 1,
    type: 'file',
    extension: ['mp3'],
    success: async (res) => {
      const filePath = res.tempFiles[0].path;
      const fileID = await audioManager.uploadCustomSound(filePath);
      uni.showToast({ title: 'ä¸Šä¼ æˆåŠŸï¼' });
    }
  });
};
</script>
```

---

## ğŸ›ï¸ åŠŸèƒ½ 6: çš®è‚¤å•†åŸ

### è®¾è®¡ç›®æ ‡
å»ºç«‹è™šæ‹Ÿå•†å“ç»æµç³»ç»Ÿï¼Œæä¾›å¤šæ ·åŒ–çš„è§†è§‰å®šåˆ¶é€‰é¡¹ï¼Œå¹¶å®ç°å˜ç°ã€‚

### å•†å“åˆ†ç±»

#### A. å—æ°”åŒ…çš®è‚¤
| çš®è‚¤åç§° | æ•ˆæœ | ä»·æ ¼ | ç±»å‹ |
|----------|------|------|------|
| ç»å…¸æ¬¾ | é»˜è®¤ä¸‘èŒè„¸ | å…è´¹ | é»˜è®¤ |
| çŒªå¤´ | ç²‰è‰²å°çŒª | 100 é‡‘å¸ | æ™®é€š |
| è¥¿ç“œ | è¢«æ‰“ç¢å¼€è£‚ | 500 é‡‘å¸ | ç¨€æœ‰ |
| åœ°çƒ | å®‡å®™çº§æ‰“å‡» | 1000 é‡‘å¸ | å²è¯— |
| è€æ¿è„¸ | è‡ªå®šä¹‰ä¸Šä¼  | 9.9 å…ƒ | ä»˜è´¹ |
| èµ›åšæœ‹å…‹ | éœ“è™¹ç‰¹æ•ˆ | 19.9 å…ƒ | ä»˜è´¹ |

#### B. èƒŒæ™¯ä¸»é¢˜
| ä¸»é¢˜ | åœºæ™¯ | ä»·æ ¼ |
|------|------|------|
| åŠå…¬å®¤ | å·¥ä½ã€ç”µè„‘ | å…è´¹ |
| æ‹³å‡»æ“‚å° | æ‹³å°ã€è§‚ä¼— | 300 é‡‘å¸ |
| å¤ªç©º | æ˜Ÿç©ºã€æµæ˜Ÿ | 600 é‡‘å¸ |
| åœ°ç‹± | ç«ç„°ã€ç†”å²© | 12.9 å…ƒ |

#### C. ç‰¹æ•ˆåŒ…
| ç‰¹æ•ˆ | æ•ˆæœ | ä»·æ ¼ |
|------|------|------|
| ç«ç„°æ‹³ | æ‰“å‡»å¸¦ç«ç„° | 200 é‡‘å¸ |
| å†°å†» | ç»“å†°è£‚å¼€ | 400 é‡‘å¸ |
| é—ªç”µ | é›·ç”µé“¾ | 6.9 å…ƒ |

### è´§å¸ç³»ç»Ÿ

#### é‡‘å¸è·å–é€”å¾„
- âœ… å®Œæˆæ¯æ—¥ä»»åŠ¡ï¼š50-200 é‡‘å¸/å¤©
- âœ… è¾¾æˆæˆå°±ï¼š100-500 é‡‘å¸
- âœ… è§‚çœ‹æ¿€åŠ±å¹¿å‘Šï¼š20 é‡‘å¸/æ¬¡ï¼ˆæ¯æ—¥ä¸Šé™ 5 æ¬¡ï¼‰
- âœ… å¥½å‹å¯¹æˆ˜è·èƒœï¼š30 é‡‘å¸/æ¬¡

#### ä»˜è´¹ç‚¹è®¾è®¡
- **å•å“è´­ä¹°**ï¼š6.9-19.9 å…ƒ
- **æœˆå¡**ï¼š18 å…ƒï¼ˆæ¯æ—¥èµ é€ 100 é‡‘å¸ + VIP ç‰¹æƒï¼‰
- **ç¤¼åŒ…**ï¼š68 å…ƒï¼ˆ10 æ¬¾çš®è‚¤ + 5 æ¬¾æ­¦å™¨ + 3000 é‡‘å¸ï¼‰

### æŠ€æœ¯å®ç°

#### å•†åŸæ•°æ®ç»“æ„
```javascript
// äº‘æ•°æ®åº“é›†åˆï¼šshop_items
{
  _id: "item_xxx",
  type: "skin", // skin | background | effect | weapon
  name: "çŒªå¤´çš®è‚¤",
  desc: "å˜èº«å¯çˆ±å°çŒª",
  icon: "/static/shop/pig.png",
  previewImage: "/static/shop/pig_preview.gif",
  rarity: "common",
  price: {
    type: "coin", // coin | rmb
    value: 100
  },
  tags: ["æç¬‘", "åŠ¨ç‰©"],
  salesCount: 1234,
  rating: 4.8,
  onSale: true
}
```

#### è´­ä¹°æµç¨‹
```javascript
// é‡‘å¸è´­ä¹°
async function buySkinWithCoin(itemId) {
  const item = await getItemById(itemId);
  const userCoin = await getUserCoin();

  if (userCoin < item.price.value) {
    uni.showToast({ title: 'é‡‘å¸ä¸è¶³', icon: 'none' });
    return;
  }

  // è°ƒç”¨äº‘å‡½æ•°æ‰£é™¤é‡‘å¸å¹¶å‘æ”¾ç‰©å“
  const result = await wx.cloud.callFunction({
    name: 'purchaseItem',
    data: { itemId }
  });

  if (result.code === 0) {
    uni.showToast({ title: 'è´­ä¹°æˆåŠŸï¼' });
    // åˆ·æ–°èƒŒåŒ…
    refreshInventory();
  }
}

// äººæ°‘å¸è´­ä¹°
async function buySkinWithRMB(itemId) {
  const item = await getItemById(itemId);

  // è°ƒç”¨å¾®ä¿¡æ”¯ä»˜
  wx.requestPayment({
    timeStamp: '',
    nonceStr: '',
    package: '',
    signType: 'MD5',
    paySign: '',
    success: async (res) => {
      // æ”¯ä»˜æˆåŠŸåè°ƒç”¨äº‘å‡½æ•°å‘æ”¾å•†å“
      await wx.cloud.callFunction({
        name: 'grantPurchasedItem',
        data: { itemId, orderId: res.orderId }
      });
    }
  });
}
```

#### å•†åŸé¡µé¢
**æ–°å¢æ–‡ä»¶ï¼š** `pages/shop/index.vue`
```vue
<template>
  <view class="shop-page">
    <!-- ç”¨æˆ·é‡‘å¸æ˜¾ç¤º -->
    <view class="coin-bar">
      <text>ğŸ’° {{ userCoins }}</text>
      <button @click="recharge">å……å€¼</button>
    </view>

    <!-- åˆ†ç±»æ ‡ç­¾ -->
    <scroll-view scroll-x class="category-tabs">
      <view
        v-for="cat in categories"
        :key="cat"
        :class="['tab', { active: activeCategory === cat }]"
        @click="activeCategory = cat"
      >
        {{ cat }}
      </view>
    </scroll-view>

    <!-- å•†å“ç½‘æ ¼ -->
    <scroll-view scroll-y class="item-grid">
      <view
        v-for="item in filteredItems"
        :key="item._id"
        class="item-card"
        @click="showItemDetail(item)"
      >
        <image :src="item.icon" mode="aspectFill" />
        <view class="info">
          <text class="name">{{ item.name }}</text>
          <view class="price">
            <text v-if="item.price.type === 'coin'">
              ğŸ’° {{ item.price.value }}
            </text>
            <text v-else class="rmb">
              Â¥{{ item.price.value }}
            </text>
          </view>
        </view>
        <view v-if="item.owned" class="owned-badge">å·²æ‹¥æœ‰</view>
      </view>
    </scroll-view>
  </view>
</template>
```

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### æ–°å¢æ•°æ®åº“é›†åˆ

```javascript
// 1. user_weapons - ç”¨æˆ·æ­¦å™¨åº“
{
  _openid: "user123",
  unlockedWeapons: ["fist", "slipper", "durian"],
  equippedWeapon: "durian"
}

// 2. user_achievements - ç”¨æˆ·æˆå°±
{
  _openid: "user123",
  achievements: [
    { id: "first_blood", unlockedAt: Date, claimed: true }
  ]
}

// 3. battle_records - å¯¹æˆ˜è®°å½•
{
  challenger: { openid, score },
  defender: { openid, score },
  winner: "openid",
  battleTime: Date
}

// 4. user_daily_tasks - æ¯æ—¥ä»»åŠ¡
{
  _openid: "user123",
  date: "2025-12-05",
  tasks: [ /* ä»»åŠ¡æ•°æ® */ ]
}

// 5. user_custom_sounds - è‡ªå®šä¹‰éŸ³æ•ˆ
{
  _openid: "user123",
  fileID: "cloud://xxx.mp3",
  uploadTime: Date
}

// 6. shop_items - å•†åŸå•†å“
{
  type: "skin",
  name: "çŒªå¤´çš®è‚¤",
  price: { type: "coin", value: 100 }
}

// 7. user_inventory - ç”¨æˆ·èƒŒåŒ…
{
  _openid: "user123",
  skins: ["pig", "watermelon"],
  equippedSkin: "pig",
  coins: 1500
}
```

---

## ğŸ¨ UI/UX å˜æ›´

### æ–°å¢é¡µé¢
1. `/pages/weapons/index` - æ­¦å™¨åº“é¡µé¢
2. `/pages/achievements/index` - æˆå°±é¡µé¢
3. `/pages/battle/arena` - å¯¹æˆ˜ç«æŠ€åœº
4. `/pages/tasks/index` - ä»»åŠ¡ä¸­å¿ƒ
5. `/pages/sound-custom/index` - éŸ³æ•ˆå®šåˆ¶
6. `/pages/shop/index` - çš®è‚¤å•†åŸ
7. `/pages/inventory/index` - æˆ‘çš„èƒŒåŒ…

### ä¸»é¡µé¢è°ƒæ•´
**æ–‡ä»¶ï¼š** `pages/index/index.vue`
```vue
<!-- æ–°å¢åº•éƒ¨å¯¼èˆªæ  -->
<view class="bottom-nav">
  <button @click="goTo('/pages/weapons/index')">ğŸ¥Š æ­¦å™¨</button>
  <button @click="goTo('/pages/tasks/index')">ğŸ“‹ ä»»åŠ¡</button>
  <button @click="goTo('/pages/battle/arena')">âš”ï¸ å¯¹æˆ˜</button>
  <button @click="goTo('/pages/shop/index')">ğŸ›ï¸ å•†åŸ</button>
  <button @click="goTo('/pages/achievements/index')">ğŸ† æˆå°±</button>
</view>

<!-- æ–°å¢æ‚¬æµ®ä»»åŠ¡æç¤º -->
<view class="task-float-tip" v-if="hasUnclaimedReward">
  <text>æœ‰å¥–åŠ±å¯é¢†å–ï¼</text>
</view>
```

---

## ğŸ“Š æ€§èƒ½ä¸ä¼˜åŒ–

### èµ„æºåŠ è½½ä¼˜åŒ–
- **åˆ†åŒ…åŠ è½½**ï¼šå•†åŸã€æˆå°±ç­‰éæ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨åˆ†åŒ…
- **å›¾ç‰‡æ‡’åŠ è½½**ï¼šå•†åŸå•†å“å›¾ç‰‡ä½¿ç”¨æ‡’åŠ è½½
- **éŸ³æ•ˆé¢„åŠ è½½**ï¼šä»…é¢„åŠ è½½å½“å‰é€‰ä¸­çš„éŸ³æ•ˆ

### äº‘å¼€å‘ä¼˜åŒ–
- **æ•°æ®åº“ç´¢å¼•**ï¼šä¸º `_openid`ã€`date` ç­‰å­—æ®µå»ºç´¢å¼•
- **äº‘å‡½æ•°ç¼“å­˜**ï¼šæ’è¡Œæ¦œæ•°æ®ç¼“å­˜ 5 åˆ†é’Ÿ
- **CDN åŠ é€Ÿ**ï¼šé™æ€èµ„æºä½¿ç”¨äº‘å­˜å‚¨ CDN

---

## ğŸš€ å®æ–½è®¡åˆ’

### é˜¶æ®µ 1ï¼ˆ3å¤©ï¼‰ï¼šåŸºç¡€æ¶æ„
- [ ] åˆ›å»ºæ–°çš„æ•°æ®åº“é›†åˆ
- [ ] æ­å»ºçŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰
- [ ] åˆ›å»ºåŸºç¡€ç»„ä»¶æ¡†æ¶

### é˜¶æ®µ 2ï¼ˆ4å¤©ï¼‰ï¼šæ ¸å¿ƒåŠŸèƒ½å¼€å‘
- [ ] æ­¦å™¨ç³»ç»Ÿ + è§£é”é€»è¾‘
- [ ] æˆå°±ç³»ç»Ÿ + æ£€æµ‹å™¨
- [ ] æ¯æ—¥ä»»åŠ¡ + åˆ·æ–°æœºåˆ¶

### é˜¶æ®µ 3ï¼ˆ3å¤©ï¼‰ï¼šç¤¾äº¤ä¸å•†åŸ
- [ ] å¥½å‹å¯¹æˆ˜ + åˆ†äº«å¡ç‰‡
- [ ] çš®è‚¤å•†åŸ + æ”¯ä»˜é›†æˆ

### é˜¶æ®µ 4ï¼ˆ3å¤©ï¼‰ï¼šéŸ³æ•ˆä¸ä¼˜åŒ–
- [ ] éŸ³æ•ˆè‡ªå®šä¹‰ + TTS
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] çœŸæœºæµ‹è¯•

### é˜¶æ®µ 5ï¼ˆ2å¤©ï¼‰ï¼šæµ‹è¯•ä¸å‘å¸ƒ
- [ ] å®Œæ•´æµç¨‹æµ‹è¯•
- [ ] ä¿®å¤ bug
- [ ] æäº¤å®¡æ ¸

---

## âš ï¸ é£é™©ä¸æŒ‘æˆ˜

| é£é™©ç‚¹ | å½±å“ | ç¼“è§£æ–¹æ¡ˆ |
|--------|------|----------|
| å¾®ä¿¡æ”¯ä»˜æ¥å…¥é—¨æ§› | é«˜ | å…ˆå®ç°é‡‘å¸ç³»ç»Ÿï¼Œæ”¯ä»˜åç»­æ¥å…¥ |
| äº‘å¼€å‘å…è´¹é¢åº¦è¶…é™ | ä¸­ | å®æ–½æ•°æ®ç¼“å­˜ + CDN |
| ç”¨æˆ·ä¸Šä¼ éŸ³æ•ˆå®¡æ ¸ | é«˜ | å…ˆåšé¢„è®¾éŸ³æ•ˆåº“ï¼Œè‡ªå®šä¹‰åŠŸèƒ½åç»­å¼€æ”¾ |
| å¥½å‹å¯¹æˆ˜å®æ—¶æ€§è¦æ±‚ | ä¸­ | é‡‡ç”¨å¼‚æ­¥å¯¹æˆ˜ï¼Œé™ä½æŠ€æœ¯å¤æ‚åº¦ |

---

## ğŸ“ˆ æˆåŠŸæŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ |
|------|--------|--------|
| 7æ—¥ç•™å­˜ç‡ | 20% | 40% |
| æ—¥å‡ä½¿ç”¨æ—¶é•¿ | 2åˆ†é’Ÿ | 5åˆ†é’Ÿ |
| ä»˜è´¹è½¬åŒ–ç‡ | 0% | 3% |
| æ—¥æ´»è·ƒç”¨æˆ· | - | 1000+ |
| åˆ†äº«ç‡ | 5% | 15% |

---

## ğŸ’¬ å¾…è®¨è®ºé—®é¢˜

1. **ä»˜è´¹å®šä»·ç­–ç•¥**ï¼šå•å“ 6.9-19.9 å…ƒæ˜¯å¦åˆç†ï¼Ÿ
2. **æ­¦å™¨å¹³è¡¡æ€§**ï¼šé«˜ç¨€æœ‰åº¦æ­¦å™¨çš„ä¼¤å®³å€ç‡ä¸Šé™ï¼Ÿ
3. **é˜²æ²‰è¿·æœºåˆ¶**ï¼šæ˜¯å¦éœ€è¦é™åˆ¶æ¯æ—¥æ¸¸æˆæ—¶é•¿ï¼Ÿ
4. **å®¡æ ¸é£é™©**ï¼šæç¬‘éŸ³æ•ˆå’Œè¡¨æƒ…åŒ…æ˜¯å¦ä¼šè§¦å‘å®¡æ ¸ï¼Ÿ

---

## ğŸ“ å®¡æ‰¹æµç¨‹

- [ ] äº§å“ç»ç†å®¡æ‰¹
- [ ] æŠ€æœ¯è´Ÿè´£äººè¯„å®¡
- [ ] UI/UX è®¾è®¡å¸ˆç¡®è®¤
- [ ] å¼€å§‹å¼€å‘

**ææ¡ˆäººï¼š** GitHub Copilot
**è”ç³»æ–¹å¼ï¼š** -
**æœŸæœ›å¼€å§‹æ—¶é—´ï¼š** 2025å¹´12æœˆ10æ—¥
